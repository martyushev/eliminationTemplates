function [C,U,dU] = coefs_stitching(data)

    c1 = data{1};
    c2 = data{2};

    C = zeros(2,16);

    C(1) = c1(1);
    C(3) = c1(2);
    C(5) = c1(3);
    C(7) = c1(4);
    C(9) = c1(5);
    C(11) = c1(6);
    C(13) = c1(7);
    C(15) = c1(8);
    C(19) = c1(9);
    C(17) = c1(10);
    C(21) = c1(11);
    C(25) = c1(12);
    C(23) = c1(13);
    C(27) = c1(14);
    C(29) = c1(15);
    C(31) = c1(16);
    C(2) = c2(1);
    C(4) = c2(2);
    C(6) = c2(3);
    C(8) = c2(4);
    C(10) = c2(5);
    C(12) = c2(6);
    C(14) = c2(7);
    C(16) = c2(8);
    C(20) = c2(9);
    C(18) = c2(10);
    C(22) = c2(11);
    C(26) = c2(12);
    C(24) = c2(13);
    C(28) = c2(14);
    C(30) = c2(15);
    C(32) = c2(16);

    C = C./repmat(sqrt(sum(C.*conj(C),2)),1,size(C,2));

    U = @(S,n)[S(1,:).^6.*S(2,:).^3;S(1,:).^5.*S(2,:).^3;S(1,:).^4.*S(2,:).^3;S(1,:).^4.*S(2,:).^2;S(2,:).^3.*S(1,:).^3;S(2,:).^2.*S(1,:).^3;S(2,:).^3.*S(1,:).^2;S(2,:).^2.*S(1,:).^2;S(2,:).^3.*S(1,:);S(2,:).*S(1,:).^2;S(2,:).^2.*S(1,:);S(2,:).^3;S(1,:).*S(2,:);S(2,:).^2;S(2,:);ones(1,n)];
    dU = @(S,n)[[6.*S(1,:).^5.*S(2,:).^3;5.*S(1,:).^4.*S(2,:).^3;4.*S(2,:).^3.*S(1,:).^3;4.*S(2,:).^2.*S(1,:).^3;3.*S(2,:).^3.*S(1,:).^2;3.*S(2,:).^2.*S(1,:).^2;2.*S(2,:).^3.*S(1,:);2.*S(2,:).^2.*S(1,:);S(2,:).^3;2.*S(1,:).*S(2,:);S(2,:).^2;zeros(1,n);S(2,:);zeros(1,n);zeros(1,n);zeros(1,n)],[3.*S(1,:).^6.*S(2,:).^2;3.*S(1,:).^5.*S(2,:).^2;3.*S(1,:).^4.*S(2,:).^2;2.*S(1,:).^4.*S(2,:);3.*S(2,:).^2.*S(1,:).^3;2.*S(2,:).*S(1,:).^3;3.*S(2,:).^2.*S(1,:).^2;2.*S(2,:).*S(1,:).^2;3.*S(2,:).^2.*S(1,:);S(1,:).^2;2.*S(1,:).*S(2,:);3.*S(2,:).^2;S(1,:);2.*S(2,:);ones(1,n);zeros(1,n)]];

end