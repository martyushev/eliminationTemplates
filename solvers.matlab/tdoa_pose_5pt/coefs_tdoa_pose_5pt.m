function [C,U,dU] = coefs_tdoa_pose_5pt(data)

    U = data{1};
    cosangles = data{2};

    C = zeros(5,33);

    C([11,12,13,14,15,76,77,78,79,80,81,82,83,84,85]) = 2;
    C([6,16,26,31,106,116]) = -cosangles(1)^2;
    C([7,17,27,32,107,117]) = -cosangles(2)^2;
    C([8,18,28,33,108,118]) = -cosangles(3)^2;
    C([9,19,29,34,109,119]) = -cosangles(4)^2;
    C([10,20,30,35,110,120]) = -cosangles(5)^2;
    C(91) = 2*U(1)*U(2);
    C(136) = 2*U(1)*U(3);
    C(141) = 2*U(2)*U(3);
    C(92) = 2*U(4)*U(5);
    C(137) = 2*U(4)*U(6);
    C(142) = 2*U(5)*U(6);
    C(93) = 2*U(7)*U(8);
    C(138) = 2*U(7)*U(9);
    C(143) = 2*U(8)*U(9);
    C(94) = 2*U(10)*U(11);
    C(139) = 2*U(10)*U(12);
    C(144) = 2*U(11)*U(12);
    C(95) = 2*U(13)*U(14);
    C(140) = 2*U(13)*U(15);
    C(145) = 2*U(14)*U(15);
    C([46,146]) = 2*cosangles(1)^2*U(1);
    C([51,151]) = 2*cosangles(1)^2*U(2);
    C([66,71]) = 2*cosangles(1)^2*U(3);
    C([47,147]) = 2*cosangles(2)^2*U(4);
    C([52,152]) = 2*cosangles(2)^2*U(5);
    C([67,72]) = 2*cosangles(2)^2*U(6);
    C([48,148]) = 2*cosangles(3)^2*U(7);
    C([53,153]) = 2*cosangles(3)^2*U(8);
    C([68,73]) = 2*cosangles(3)^2*U(9);
    C([49,149]) = 2*cosangles(4)^2*U(10);
    C([54,154]) = 2*cosangles(4)^2*U(11);
    C([69,74]) = 2*cosangles(4)^2*U(12);
    C([50,150]) = 2*cosangles(5)^2*U(13);
    C([55,155]) = 2*cosangles(5)^2*U(14);
    C([70,75]) = 2*cosangles(5)^2*U(15);
    C([56,121]) = -2*U(1);
    C([41,126]) = -2*U(2);
    C([101,111]) = -2*U(3);
    C([57,122]) = -2*U(4);
    C([42,127]) = -2*U(5);
    C([102,112]) = -2*U(6);
    C([58,123]) = -2*U(7);
    C([43,128]) = -2*U(8);
    C([103,113]) = -2*U(9);
    C([59,124]) = -2*U(10);
    C([44,129]) = -2*U(11);
    C([104,114]) = -2*U(12);
    C([60,125]) = -2*U(13);
    C([45,130]) = -2*U(14);
    C([105,115]) = -2*U(15);
    C([1,21,131]) = 1-cosangles(1)^2;
    C([2,22,132]) = 1-cosangles(2)^2;
    C([3,23,133]) = 1-cosangles(3)^2;
    C([4,24,134]) = 1-cosangles(4)^2;
    C([5,25,135]) = 1-cosangles(5)^2;
    C(36) = 2*cosangles(1)^2*U(1)-2*U(1);
    C(61) = 2*cosangles(1)^2*U(2)-2*U(2);
    C(156) = 2*cosangles(1)^2*U(3)-2*U(3);
    C(37) = 2*cosangles(2)^2*U(4)-2*U(4);
    C(62) = 2*cosangles(2)^2*U(5)-2*U(5);
    C(157) = 2*cosangles(2)^2*U(6)-2*U(6);
    C(38) = 2*cosangles(3)^2*U(7)-2*U(7);
    C(63) = 2*cosangles(3)^2*U(8)-2*U(8);
    C(158) = 2*cosangles(3)^2*U(9)-2*U(9);
    C(39) = 2*cosangles(4)^2*U(10)-2*U(10);
    C(64) = 2*cosangles(4)^2*U(11)-2*U(11);
    C(159) = 2*cosangles(4)^2*U(12)-2*U(12);
    C(40) = 2*cosangles(5)^2*U(13)-2*U(13);
    C(65) = 2*cosangles(5)^2*U(14)-2*U(14);
    C(160) = 2*cosangles(5)^2*U(15)-2*U(15);
    C(161) = U(3)^2-cosangles(1)^2*U(1)^2-cosangles(1)^2*U(2)^2-cosangles(1)^2*U(3)^2;
    C(162) = U(6)^2-cosangles(2)^2*U(4)^2-cosangles(2)^2*U(5)^2-cosangles(2)^2*U(6)^2;
    C(164) = U(12)^2-cosangles(4)^2*U(10)^2-cosangles(4)^2*U(11)^2-cosangles(4)^2*U(12)^2;
    C(86) = -cosangles(1)^2*U(1)^2-cosangles(1)^2*U(2)^2-cosangles(1)^2*U(3)^2+U(1)^2;
    C(96) = -cosangles(1)^2*U(1)^2-cosangles(1)^2*U(2)^2-cosangles(1)^2*U(3)^2+U(2)^2;
    C(87) = -cosangles(2)^2*U(4)^2-cosangles(2)^2*U(5)^2-cosangles(2)^2*U(6)^2+U(4)^2;
    C(97) = -cosangles(2)^2*U(4)^2-cosangles(2)^2*U(5)^2-cosangles(2)^2*U(6)^2+U(5)^2;
    C(88) = -cosangles(3)^2*U(7)^2-cosangles(3)^2*U(8)^2-cosangles(3)^2*U(9)^2+U(7)^2;
    C(98) = -cosangles(3)^2*U(7)^2-cosangles(3)^2*U(8)^2-cosangles(3)^2*U(9)^2+U(8)^2;
    C(163) = -cosangles(3)^2*U(9)^2+U(9)^2-cosangles(3)^2*U(7)^2-cosangles(3)^2*U(8)^2;
    C(89) = -cosangles(4)^2*U(10)^2-cosangles(4)^2*U(11)^2-cosangles(4)^2*U(12)^2+U(10)^2;
    C(99) = -cosangles(4)^2*U(10)^2-cosangles(4)^2*U(11)^2-cosangles(4)^2*U(12)^2+U(11)^2;
    C(90) = -cosangles(5)^2*U(13)^2-cosangles(5)^2*U(14)^2-cosangles(5)^2*U(15)^2+U(13)^2;
    C(100) = -cosangles(5)^2*U(13)^2-cosangles(5)^2*U(14)^2-cosangles(5)^2*U(15)^2+U(14)^2;
    C(165) = -cosangles(5)^2*U(14)^2-cosangles(5)^2*U(15)^2+U(15)^2-cosangles(5)^2*U(13)^2;

    C = C./repmat(sqrt(sum(C.*conj(C),2)),1,size(C,2));

    U = @(S,n)[S(1,:).^2.*S(3,:).^2;S(3,:).^2.*S(2,:).^2;S(1,:).*S(3,:).*S(2,:).*S(4,:);S(4,:).^2.*S(1,:).^2;S(2,:).^2.*S(4,:).^2;S(5,:).^2.*S(1,:).^2;S(5,:).^2.*S(2,:).^2;S(3,:).*S(1,:).^2;S(3,:).*S(2,:).*S(1,:);S(3,:).*S(2,:).^2;S(4,:).*S(1,:).^2;S(4,:).*S(2,:).*S(1,:);S(4,:).*S(2,:).^2;S(5,:).*S(1,:).^2;S(5,:).*S(2,:).^2;S(5,:).*S(3,:).*S(1,:);S(5,:).*S(4,:).*S(2,:);S(1,:).^2;S(1,:).*S(2,:);S(2,:).^2;S(1,:).*S(3,:);S(3,:).^2;S(2,:).*S(4,:);S(4,:).^2;S(1,:).*S(5,:);S(2,:).*S(5,:);S(5,:).^2;S(1,:);S(2,:);S(3,:);S(4,:);S(5,:);ones(1,n)];
    dU = @(S,n)[[2.*S(3,:).^2.*S(1,:);zeros(1,n);S(4,:).*S(3,:).*S(2,:);2.*S(4,:).^2.*S(1,:);zeros(1,n);2.*S(5,:).^2.*S(1,:);zeros(1,n);2.*S(1,:).*S(3,:);S(2,:).*S(3,:);zeros(1,n);2.*S(1,:).*S(4,:);S(2,:).*S(4,:);zeros(1,n);2.*S(1,:).*S(5,:);zeros(1,n);S(3,:).*S(5,:);zeros(1,n);2.*S(1,:);S(2,:);zeros(1,n);S(3,:);zeros(1,n);zeros(1,n);zeros(1,n);S(5,:);zeros(1,n);zeros(1,n);ones(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n)],[zeros(1,n);2.*S(3,:).^2.*S(2,:);S(4,:).*S(3,:).*S(1,:);zeros(1,n);2.*S(4,:).^2.*S(2,:);zeros(1,n);2.*S(5,:).^2.*S(2,:);zeros(1,n);S(1,:).*S(3,:);2.*S(2,:).*S(3,:);zeros(1,n);S(1,:).*S(4,:);2.*S(2,:).*S(4,:);zeros(1,n);2.*S(2,:).*S(5,:);zeros(1,n);S(4,:).*S(5,:);zeros(1,n);S(1,:);2.*S(2,:);zeros(1,n);zeros(1,n);S(4,:);zeros(1,n);zeros(1,n);S(5,:);zeros(1,n);zeros(1,n);ones(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n)],[2.*S(3,:).*S(1,:).^2;2.*S(3,:).*S(2,:).^2;S(4,:).*S(2,:).*S(1,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(1,:).^2;S(1,:).*S(2,:);S(2,:).^2;zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(1,:).*S(5,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(1,:);2.*S(3,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);ones(1,n);zeros(1,n);zeros(1,n);zeros(1,n)],[zeros(1,n);zeros(1,n);S(3,:).*S(2,:).*S(1,:);2.*S(4,:).*S(1,:).^2;2.*S(4,:).*S(2,:).^2;zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(1,:).^2;S(1,:).*S(2,:);S(2,:).^2;zeros(1,n);zeros(1,n);zeros(1,n);S(2,:).*S(5,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(2,:);2.*S(4,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);ones(1,n);zeros(1,n);zeros(1,n)],[zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);2.*S(5,:).*S(1,:).^2;2.*S(5,:).*S(2,:).^2;zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(1,:).^2;S(2,:).^2;S(1,:).*S(3,:);S(2,:).*S(4,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);S(1,:);S(2,:);2.*S(5,:);zeros(1,n);zeros(1,n);zeros(1,n);zeros(1,n);ones(1,n);zeros(1,n)]];

end