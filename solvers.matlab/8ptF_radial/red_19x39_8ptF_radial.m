% Input: coefficient matrix C of size 3x39
% Output: solution matrix S of size 3x20

function S = red_19x39_8ptF_radial(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],[17,18,19,33,34,35,36,37,38,39,7,8,14,15,17,27,30,31,33,36,9,15,16,18,27,28,31,32,34,37,8,9,29,33,34,35,36,37,38,39,1,2,3,7,10,11,14,23,24,30,5,12,13,16,20,21,25,26,28,32,3,4,6,7,8,27,30,31,33,36,2,4,11,12,15,20,24,25,27,31,4,5,9,22,27,28,31,32,34,37,17,18,19,33,34,35,36,37,38,39,7,8,14,15,17,27,30,31,33,36,9,15,16,18,27,28,31,32,34,37,8,9,29,33,34,35,36,37,38,39,1,2,3,7,10,11,14,23,24,30,5,12,13,16,20,21,25,26,28,32,3,4,6,7,8,27,30,31,33,36,2,4,11,12,15,20,24,25,27,31,4,5,9,22,27,28,31,32,34,37,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],C([106,109,115,79,82,85,97,100,103,112,79,85,106,109,115,82,97,100,103,112,85,106,109,115,79,82,97,100,103,112,79,82,85,97,100,103,106,109,112,115,79,82,85,103,106,109,115,97,100,112,85,106,109,115,79,82,97,100,103,112,79,82,85,97,103,100,106,109,112,115,79,85,106,109,115,82,97,100,103,112,79,82,103,85,97,100,106,109,112,115,107,110,116,80,83,86,98,101,104,113,80,86,107,110,116,83,98,101,104,113,86,107,110,116,80,83,98,101,104,113,80,83,86,98,101,104,107,110,113,116,80,83,86,104,107,110,116,98,101,113,86,107,110,116,80,83,98,101,104,113,80,83,86,98,104,101,107,110,113,116,80,86,107,110,116,83,98,101,104,113,80,83,104,86,98,101,107,110,113,116,3,6,15,18,21,24,42,51,54,60,63,66,69,90,93,96,108,111,117,9,12,27,30,33,36,39,45,48,57,72,75,78,81,84,87,99,102,105,114]),19,39);

    [L,~,p] = lu(M(:,1:8),'vector');
    M = M(p(end-10:end),9:end)-L(end-10:end,:)*(L(1:8,:)\M(p(1:8),9:end));
    %[M,~] = qr(M(:,1:8),M(:,9:end));
    %M = M(end-10:end,:);

    T0 = zeros(20);
    T0([3,4,5,6,7,11,12,13,17,18,20],:) = -M(:,12:end);
    T0([101,122,228,249,310,334,355,376,399]) = 1;
    T1 = zeros(20);
    T1([3,4,5,6,7,11,12,13,17,18,20],[3,4,5,6,7,11,12,13,17,18,20]) = M(:,1:11);
    T1([1,22,148,169,190,274,295,316,379]) = 1;

    [V,~] = eig(T0,T1);
    S = V(17:19,:)./repmat(V(20,:),3,1);
    S = S(:,all(isfinite(S)));

end