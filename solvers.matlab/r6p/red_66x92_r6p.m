% Input: coefficient matrix C of size 6x16
% Output: solution matrix S of size 6x26

function S = red_66x92_r6p(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66],[35,36,37,38,39,40,41,42,63,64,65,66,82,83,84,85,25,26,27,28,31,32,35,36,57,58,60,63,77,78,80,82,27,28,29,30,37,38,50,51,58,59,61,64,78,79,83,92,31,32,33,34,39,40,50,51,60,61,62,65,80,81,84,92,7,8,9,10,15,16,25,26,45,46,49,57,70,71,74,77,11,12,13,14,19,20,29,30,47,48,53,59,72,73,79,90,21,22,23,24,33,34,43,44,54,55,56,62,75,76,81,91,15,16,17,18,21,22,31,32,49,52,54,60,74,75,80,89,9,10,11,12,17,18,27,28,46,47,52,58,71,72,78,89,17,18,19,20,43,44,50,51,52,53,55,61,89,90,91,92,1,2,3,4,5,6,67,68,69,86,87,88,89,90,91,92,35,36,37,38,39,40,41,42,63,64,65,66,82,83,84,85,25,26,27,28,31,32,35,36,57,58,60,63,77,78,80,82,27,28,29,30,37,38,50,51,58,59,61,64,78,79,83,92,31,32,33,34,39,40,50,51,60,61,62,65,80,81,84,92,7,8,9,10,15,16,25,26,45,46,49,57,70,71,74,77,11,12,13,14,19,20,29,30,47,48,53,59,72,73,79,90,21,22,23,24,33,34,43,44,54,55,56,62,75,76,81,91,15,16,17,18,21,22,31,32,49,52,54,60,74,75,80,89,9,10,11,12,17,18,27,28,46,47,52,58,71,72,78,89,17,18,19,20,43,44,50,51,52,53,55,61,89,90,91,92,1,2,3,4,5,6,67,68,69,86,87,88,89,90,91,92,35,36,37,38,39,40,41,42,63,64,65,66,82,83,84,85,25,26,27,28,31,32,35,36,57,58,60,63,77,78,80,82,27,28,29,30,37,38,50,51,58,59,61,64,78,79,83,92,31,32,33,34,39,40,50,51,60,61,62,65,80,81,84,92,7,8,9,10,15,16,25,26,45,46,49,57,70,71,74,77,11,12,13,14,19,20,29,30,47,48,53,59,72,73,79,90,21,22,23,24,33,34,43,44,54,55,56,62,75,76,81,91,15,16,17,18,21,22,31,32,49,52,54,60,74,75,80,89,9,10,11,12,17,18,27,28,46,47,52,58,71,72,78,89,17,18,19,20,43,44,50,51,52,53,55,61,89,90,91,92,1,2,3,4,5,6,67,68,69,86,87,88,89,90,91,92,35,36,37,38,39,40,41,42,63,64,65,66,82,83,84,85,25,26,27,28,31,32,35,36,57,58,60,63,77,78,80,82,27,28,29,30,37,38,50,51,58,59,61,64,78,79,83,92,31,32,33,34,39,40,50,51,60,61,62,65,80,81,84,92,7,8,9,10,15,16,25,26,45,46,49,57,70,71,74,77,11,12,13,14,19,20,29,30,47,48,53,59,72,73,79,90,21,22,23,24,33,34,43,44,54,55,56,62,75,76,81,91,15,16,17,18,21,22,31,32,49,52,54,60,74,75,80,89,9,10,11,12,17,18,27,28,46,47,52,58,71,72,78,89,17,18,19,20,43,44,50,51,52,53,55,61,89,90,91,92,1,2,3,4,5,6,67,68,69,86,87,88,89,90,91,92,35,36,37,38,39,40,41,42,63,64,65,66,82,83,84,85,25,26,27,28,31,32,35,36,57,58,60,63,77,78,80,82,27,28,29,30,37,38,50,51,58,59,61,64,78,79,83,92,31,32,33,34,39,40,50,51,60,61,62,65,80,81,84,92,7,8,9,10,15,16,25,26,45,46,49,57,70,71,74,77,11,12,13,14,19,20,29,30,47,48,53,59,72,73,79,90,21,22,23,24,33,34,43,44,54,55,56,62,75,76,81,91,15,16,17,18,21,22,31,32,49,52,54,60,74,75,80,89,9,10,11,12,17,18,27,28,46,47,52,58,71,72,78,89,17,18,19,20,43,44,50,51,52,53,55,61,89,90,91,92,1,2,3,4,5,6,67,68,69,86,87,88,89,90,91,92,35,36,37,38,39,40,41,42,63,64,65,66,82,83,84,85,25,26,27,28,31,32,35,36,57,58,60,63,77,78,80,82,27,28,29,30,37,38,50,51,58,59,61,64,78,79,83,92,31,32,33,34,39,40,50,51,60,61,62,65,80,81,84,92,7,8,9,10,15,16,25,26,45,46,49,57,70,71,74,77,11,12,13,14,19,20,29,30,47,48,53,59,72,73,79,90,21,22,23,24,33,34,43,44,54,55,56,62,75,76,81,91,15,16,17,18,21,22,31,32,49,52,54,60,74,75,80,89,9,10,11,12,17,18,27,28,46,47,52,58,71,72,78,89,17,18,19,20,43,44,50,51,52,53,55,61,89,90,91,92,1,2,3,4,5,6,67,68,69,86,87,88,89,90,91,92],C([1,7,19,25,37,43,55,61,73,79,85,91,13,31,49,67,1,7,19,25,37,43,55,61,73,79,85,91,13,31,49,67,1,7,19,25,55,61,37,43,73,79,85,91,13,31,67,49,1,7,37,43,55,61,19,25,73,79,85,91,13,49,67,31,1,7,19,25,37,43,55,61,73,79,85,91,13,31,49,67,1,7,19,25,37,43,55,61,73,79,85,91,13,31,67,49,1,7,37,43,55,61,19,25,73,79,85,91,13,49,67,31,1,7,19,25,37,43,55,61,73,79,85,91,13,49,67,31,1,7,19,25,37,43,55,61,73,79,85,91,13,31,67,49,1,7,19,25,37,43,55,61,73,79,85,91,13,31,49,67,1,7,13,19,25,31,37,43,49,55,61,67,73,79,85,91,2,8,20,26,38,44,56,62,74,80,86,92,14,32,50,68,2,8,20,26,38,44,56,62,74,80,86,92,14,32,50,68,2,8,20,26,56,62,38,44,74,80,86,92,14,32,68,50,2,8,38,44,56,62,20,26,74,80,86,92,14,50,68,32,2,8,20,26,38,44,56,62,74,80,86,92,14,32,50,68,2,8,20,26,38,44,56,62,74,80,86,92,14,32,68,50,2,8,38,44,56,62,20,26,74,80,86,92,14,50,68,32,2,8,20,26,38,44,56,62,74,80,86,92,14,50,68,32,2,8,20,26,38,44,56,62,74,80,86,92,14,32,68,50,2,8,20,26,38,44,56,62,74,80,86,92,14,32,50,68,2,8,14,20,26,32,38,44,50,56,62,68,74,80,86,92,3,9,21,27,39,45,57,63,75,81,87,93,15,33,51,69,3,9,21,27,39,45,57,63,75,81,87,93,15,33,51,69,3,9,21,27,57,63,39,45,75,81,87,93,15,33,69,51,3,9,39,45,57,63,21,27,75,81,87,93,15,51,69,33,3,9,21,27,39,45,57,63,75,81,87,93,15,33,51,69,3,9,21,27,39,45,57,63,75,81,87,93,15,33,69,51,3,9,39,45,57,63,21,27,75,81,87,93,15,51,69,33,3,9,21,27,39,45,57,63,75,81,87,93,15,51,69,33,3,9,21,27,39,45,57,63,75,81,87,93,15,33,69,51,3,9,21,27,39,45,57,63,75,81,87,93,15,33,51,69,3,9,15,21,27,33,39,45,51,57,63,69,75,81,87,93,4,10,22,28,40,46,58,64,76,82,88,94,16,34,52,70,4,10,22,28,40,46,58,64,76,82,88,94,16,34,52,70,4,10,22,28,58,64,40,46,76,82,88,94,16,34,70,52,4,10,40,46,58,64,22,28,76,82,88,94,16,52,70,34,4,10,22,28,40,46,58,64,76,82,88,94,16,34,52,70,4,10,22,28,40,46,58,64,76,82,88,94,16,34,70,52,4,10,40,46,58,64,22,28,76,82,88,94,16,52,70,34,4,10,22,28,40,46,58,64,76,82,88,94,16,52,70,34,4,10,22,28,40,46,58,64,76,82,88,94,16,34,70,52,4,10,22,28,40,46,58,64,76,82,88,94,16,34,52,70,4,10,16,22,28,34,40,46,52,58,64,70,76,82,88,94,5,11,23,29,41,47,59,65,77,83,89,95,17,35,53,71,5,11,23,29,41,47,59,65,77,83,89,95,17,35,53,71,5,11,23,29,59,65,41,47,77,83,89,95,17,35,71,53,5,11,41,47,59,65,23,29,77,83,89,95,17,53,71,35,5,11,23,29,41,47,59,65,77,83,89,95,17,35,53,71,5,11,23,29,41,47,59,65,77,83,89,95,17,35,71,53,5,11,41,47,59,65,23,29,77,83,89,95,17,53,71,35,5,11,23,29,41,47,59,65,77,83,89,95,17,53,71,35,5,11,23,29,41,47,59,65,77,83,89,95,17,35,71,53,5,11,23,29,41,47,59,65,77,83,89,95,17,35,53,71,5,11,17,23,29,35,41,47,53,59,65,71,77,83,89,95,6,12,24,30,42,48,60,66,78,84,90,96,18,36,54,72,6,12,24,30,42,48,60,66,78,84,90,96,18,36,54,72,6,12,24,30,60,66,42,48,78,84,90,96,18,36,72,54,6,12,42,48,60,66,24,30,78,84,90,96,18,54,72,36,6,12,24,30,42,48,60,66,78,84,90,96,18,36,54,72,6,12,24,30,42,48,60,66,78,84,90,96,18,36,72,54,6,12,42,48,60,66,24,30,78,84,90,96,18,54,72,36,6,12,24,30,42,48,60,66,78,84,90,96,18,54,72,36,6,12,24,30,42,48,60,66,78,84,90,96,18,36,72,54,6,12,24,30,42,48,60,66,78,84,90,96,18,36,54,72,6,12,18,24,30,36,42,48,54,60,66,72,78,84,90,96]),66,92);

    [L,~,p] = lu(M(:,1:42),'vector');
    M = M(p(end-23:end),43:end)-L(end-23:end,:)*(L(1:42,:)\M(p(1:42),43:end));
    %[M,~] = qr(M(:,1:42),M(:,43:end));
    %M = M(end-23:end,:);

    T0 = zeros(26);
    T0([1,2,4,5,6,7,8,20,21,23,24,9,25,10,11,12,13,14,26,15,16,17,18,19],:) = -M(:,25:end);
    T0([627,672]) = 1;
    T1 = zeros(26);
    T1([1,2,4,5,6,7,8,20,21,23,24,9,25,10,11,12,13,14,26,15,16,17,18,19],[1,2,4,5,6,7,8,20,21,23,24,9,25,10,11,12,13,14,26,15,16,17,18,19]) = M(:,1:24);
    T1([55,568]) = 1;

    [V,~] = eig(T0,T1);
    S = V(20:25,:)./repmat(V(26,:),6,1);
    S = S(:,all(isfinite(S)));

end