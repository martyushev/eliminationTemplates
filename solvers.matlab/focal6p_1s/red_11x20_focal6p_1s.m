% Input: coefficient matrix C of size 10x20
% Output: solution matrix S of size 3x9

function S = red_11x20_focal6p_1s(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,6,8,10,11,13,15,16,18,19,20,1,2,3,4,5,7,9,12,14,17],C([1,11,21,31,81,101,131,151,161,181,191,41,51,61,71,91,111,121,141,171,2,12,22,32,82,102,132,152,162,182,192,42,52,62,72,92,112,122,142,172,3,13,23,33,83,103,133,153,163,183,193,43,53,63,73,93,113,123,143,173,4,14,24,34,84,104,134,154,164,184,194,44,54,64,74,94,114,124,144,174,5,15,25,35,85,105,135,155,165,185,195,45,55,65,75,95,115,125,145,175,6,16,26,36,86,106,136,156,166,186,196,46,56,66,76,96,116,126,146,176,7,17,27,37,87,107,137,157,167,187,197,47,57,67,77,97,117,127,147,177,8,18,28,38,88,108,138,158,168,188,198,48,58,68,78,98,118,128,148,178,9,19,29,39,89,109,139,159,169,189,199,49,59,69,79,99,119,129,149,179,110,160,190,200,60,80,100,130,150,180,60,80,100,110,160,190,200,130,150,180]),11,20);

    [L,~,p] = lu(M(:,1:6),'vector');
    M = M(p(end-4:end),7:end)-L(end-4:end,:)*(L(1:6,:)\M(p(1:6),7:end));
    %[M,~] = qr(M(:,1:6),M(:,7:end));
    %M = M(end-4:end,:);

    T0 = zeros(9);
    T0([3,5,6,8,9],:) = -M(:,6:end);
    T0([46,56,67,79]) = 1;
    T1 = zeros(9);
    T1([3,5,6,8,9],[3,5,6,8,9]) = M(:,1:5);
    T1([1,11,31,61]) = 1;

    [V,~] = eig(T0,T1);
    S = V(6:8,:)./repmat(V(9,:),3,1);
    S = S(:,all(isfinite(S)));

end