% Input: coefficient matrix C of size 2x16
% Output: solution matrix S of size 2x8

function S = red_7x15_8ptF_radial_1s(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,6,7,12,13,14,15,5,6,10,11,12,13,3,12,13,14,15,4,5,8,9,10,11,2,3,10,11,12,13,1,2,8,9,10,11],C([1,5,11,13,21,27,31,3,7,9,15,17,23,25,29,28,32,18,24,26,30,28,32,18,24,26,30,18,24,28,30,32,28,32,18,24,26,30,18,26,24,28,30,32,18,26,24,28,30,32]),7,15);

    [L,~,p] = lu(M(:,1:3),'vector');
    M = M(p(end-3:end),4:end)-L(end-3:end,:)*(L(1:3,:)\M(p(1:3),4:end));
    %[M,~] = qr(M(:,1:3),M(:,4:end));
    %M = M(end-3:end,:);

    T0 = zeros(8);
    T0([2,4,6,8],:) = -M(:,5:end);
    T0([9,27,45,63]) = 1;
    T1 = zeros(8);
    T1([2,4,6,8],[2,4,6,8]) = M(:,1:4);
    T1([1,19,37,55]) = 1;

    [V,~] = eig(T0,T1);
    S = V(6:7,:)./repmat(V(8,:),2,1);
    S = S(:,all(isfinite(S)));

end