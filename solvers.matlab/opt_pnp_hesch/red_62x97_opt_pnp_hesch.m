% Input: coefficient matrix C of size 3x20
% Output: solution matrix S of size 3x35

function S = red_62x97_opt_pnp_hesch(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62],[1,2,3,4,36,42,43,44,45,46,48,51,63,64,65,67,68,70,73,79,2,3,4,5,45,46,47,48,49,52,66,67,68,69,70,71,72,73,74,80,7,8,9,10,14,15,16,20,21,26,27,28,32,33,39,43,77,81,84,90,8,9,10,11,15,16,17,21,22,27,28,29,33,34,35,40,41,44,53,81,12,13,14,15,18,19,20,23,30,31,32,42,72,75,76,78,82,83,85,91,13,14,15,16,19,20,21,31,32,33,42,43,73,76,77,79,83,84,86,92,14,15,16,17,20,21,22,32,33,34,35,36,41,43,44,45,50,54,77,84,18,19,20,21,23,42,43,72,73,74,75,76,77,78,79,80,85,86,87,93,19,20,21,22,35,36,42,43,44,45,46,48,50,51,55,73,76,77,79,86,23,36,42,43,44,45,46,47,48,49,51,52,56,72,73,74,78,79,80,87,24,25,26,27,30,31,32,37,38,39,75,76,78,82,83,85,88,89,91,94,25,26,27,28,31,32,33,38,39,76,77,79,81,83,84,86,89,90,92,95,26,27,28,29,32,33,34,35,36,39,40,41,50,53,54,57,77,81,84,90,30,31,32,33,75,76,77,78,79,80,82,83,84,85,86,87,91,92,93,96,31,32,33,34,35,36,41,48,50,51,54,55,58,76,77,79,83,84,86,92,35,36,48,49,50,51,52,55,56,59,75,76,77,78,79,80,85,86,87,93,37,38,39,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,38,39,40,41,50,51,53,54,55,57,58,60,81,83,84,86,89,90,92,95,41,50,51,52,54,55,56,58,59,61,82,83,84,85,86,87,91,92,93,96,53,54,55,56,57,58,59,60,61,62,88,89,90,91,92,93,94,95,96,97,1,2,3,4,36,42,43,44,45,46,48,51,63,64,65,67,68,70,73,79,2,3,4,5,45,46,47,48,49,52,66,67,68,69,70,71,72,73,74,80,6,7,8,9,13,14,15,19,20,25,26,27,31,32,38,39,42,76,83,89,7,8,9,10,14,15,16,20,21,26,27,28,32,33,39,43,77,81,84,90,8,9,10,11,15,16,17,21,22,27,28,29,33,34,35,40,41,44,53,81,12,13,14,15,18,19,20,23,30,31,32,42,72,75,76,78,82,83,85,91,13,14,15,16,19,20,21,31,32,33,42,43,73,76,77,79,83,84,86,92,14,15,16,17,20,21,22,32,33,34,35,36,41,43,44,45,50,54,77,84,18,19,20,21,23,42,43,72,73,74,75,76,77,78,79,80,85,86,87,93,19,20,21,22,35,36,42,43,44,45,46,48,50,51,55,73,76,77,79,86,23,36,42,43,44,45,46,47,48,49,51,52,56,72,73,74,78,79,80,87,24,25,26,27,30,31,32,37,38,39,75,76,78,82,83,85,88,89,91,94,25,26,27,28,31,32,33,38,39,76,77,79,81,83,84,86,89,90,92,95,26,27,28,29,32,33,34,35,36,39,40,41,50,53,54,57,77,81,84,90,30,31,32,33,75,76,77,78,79,80,82,83,84,85,86,87,91,92,93,96,31,32,33,34,35,36,41,48,50,51,54,55,58,76,77,79,83,84,86,92,35,36,48,49,50,51,52,55,56,59,75,76,77,78,79,80,85,86,87,93,37,38,39,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,38,39,40,41,50,51,53,54,55,57,58,60,81,83,84,86,89,90,92,95,41,50,51,52,54,55,56,58,59,61,82,83,84,85,86,87,91,92,93,96,53,54,55,56,57,58,59,60,61,62,88,89,90,91,92,93,94,95,96,97,1,2,3,4,36,42,43,44,45,46,48,51,63,64,65,67,68,70,73,79,2,3,4,5,45,46,47,48,49,52,66,67,68,69,70,71,72,73,74,80,6,7,8,9,13,14,15,19,20,25,26,27,31,32,38,39,42,76,83,89,7,8,9,10,14,15,16,20,21,26,27,28,32,33,39,43,77,81,84,90,8,9,10,11,15,16,17,21,22,27,28,29,33,34,35,40,41,44,53,81,12,13,14,15,18,19,20,23,30,31,32,42,72,75,76,78,82,83,85,91,13,14,15,16,19,20,21,31,32,33,42,43,73,76,77,79,83,84,86,92,14,15,16,17,20,21,22,32,33,34,35,36,41,43,44,45,50,54,77,84,18,19,20,21,23,42,43,72,73,74,75,76,77,78,79,80,85,86,87,93,19,20,21,22,35,36,42,43,44,45,46,48,50,51,55,73,76,77,79,86,23,36,42,43,44,45,46,47,48,49,51,52,56,72,73,74,78,79,80,87,24,25,26,27,30,31,32,37,38,39,75,76,78,82,83,85,88,89,91,94,25,26,27,28,31,32,33,38,39,76,77,79,81,83,84,86,89,90,92,95,26,27,28,29,32,33,34,35,36,39,40,41,50,53,54,57,77,81,84,90,30,31,32,33,75,76,77,78,79,80,82,83,84,85,86,87,91,92,93,96,31,32,33,34,35,36,41,48,50,51,54,55,58,76,77,79,83,84,86,92,35,36,48,49,50,51,52,55,56,59,75,76,77,78,79,80,85,86,87,93,37,38,39,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,38,39,40,41,50,51,53,54,55,57,58,60,81,83,84,86,89,90,92,95,41,50,51,52,54,55,56,58,59,61,82,83,84,85,86,87,91,92,93,96,53,54,55,56,57,58,59,60,61,62,88,89,90,91,92,93,94,95,96,97],C([10,19,25,28,52,31,34,37,43,46,55,58,1,4,7,13,16,22,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,1,4,7,10,13,16,19,22,25,31,34,37,40,43,49,28,46,52,55,58,1,4,7,10,13,16,19,22,25,31,34,37,40,43,46,52,55,28,58,49,1,4,7,10,13,16,19,22,31,34,37,25,28,40,43,46,49,52,55,58,1,4,7,10,13,16,19,31,34,37,22,25,28,40,43,46,49,52,55,58,1,4,7,10,13,16,19,31,34,37,43,46,52,22,25,28,55,58,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,1,4,7,10,37,43,13,16,19,25,28,46,52,55,58,22,31,34,40,49,1,37,4,7,10,19,25,28,43,46,52,55,58,13,16,22,31,34,40,49,1,4,7,10,13,16,19,31,34,37,22,25,28,40,43,46,49,52,55,58,1,4,7,10,13,16,19,31,34,22,25,28,37,40,43,46,49,52,55,58,1,4,7,10,13,16,19,25,28,31,37,43,46,52,55,58,22,34,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,1,4,7,10,19,25,37,28,43,46,52,55,58,13,16,22,31,34,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,1,4,10,19,25,28,37,43,46,52,55,58,7,13,16,22,31,34,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,11,20,26,29,53,32,35,38,44,47,56,59,2,5,8,14,17,23,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,2,5,8,11,14,17,20,23,26,32,35,38,41,44,50,53,29,47,56,59,2,5,8,11,14,17,20,23,26,32,35,38,41,44,50,29,47,53,56,59,2,5,8,11,14,17,20,23,26,32,35,38,41,44,47,53,56,29,59,50,2,5,8,11,14,17,20,23,32,35,38,26,29,41,44,47,50,53,56,59,2,5,8,11,14,17,20,32,35,38,23,26,29,41,44,47,50,53,56,59,2,5,8,11,14,17,20,32,35,38,44,47,53,23,26,29,56,59,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,2,5,8,11,38,44,14,17,20,26,29,47,53,56,59,23,32,35,41,50,2,38,5,8,11,20,26,29,44,47,53,56,59,14,17,23,32,35,41,50,2,5,8,11,14,17,20,32,35,38,23,26,29,41,44,47,50,53,56,59,2,5,8,11,14,17,20,32,35,23,26,29,38,41,44,47,50,53,56,59,2,5,8,11,14,17,20,26,29,32,38,44,47,53,56,59,23,35,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,2,5,8,11,20,26,38,29,44,47,53,56,59,14,17,23,32,35,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,2,5,11,20,26,29,38,44,47,53,56,59,8,14,17,23,32,35,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,12,21,27,30,54,33,36,39,45,48,57,60,3,6,9,15,18,24,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51,3,6,9,12,15,18,21,24,27,33,36,39,42,45,51,54,30,48,57,60,3,6,9,12,15,18,21,24,27,33,36,39,42,45,51,30,48,54,57,60,3,6,9,12,15,18,21,24,27,33,36,39,42,45,48,54,57,30,60,51,3,6,9,12,15,18,21,24,33,36,39,27,30,42,45,48,51,54,57,60,3,6,9,12,15,18,21,33,36,39,24,27,30,42,45,48,51,54,57,60,3,6,9,12,15,18,21,33,36,39,45,48,54,24,27,30,57,60,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,3,6,9,12,39,45,15,18,21,27,30,48,54,57,60,24,33,36,42,51,3,39,6,9,12,21,27,30,45,48,54,57,60,15,18,24,33,36,42,51,3,6,9,12,15,18,21,33,36,39,24,27,30,42,45,48,51,54,57,60,3,6,9,12,15,18,21,33,36,24,27,30,39,42,45,48,51,54,57,60,3,6,9,12,15,18,21,27,30,33,39,45,48,54,57,60,24,36,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,3,6,9,12,21,27,39,30,45,48,54,57,60,15,18,24,33,36,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,3,6,12,21,27,30,39,45,48,54,57,60,9,15,18,24,33,36,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51]),62,97);

    [L,~,p] = lu(M(:,1:41),'vector');
    M = M(p(end-20:end),42:end)-L(end-20:end,:)*(L(1:41,:)\M(p(1:41),42:end));
    %[M,~] = qr(M(:,1:41),M(:,42:end));
    %M = M(end-20:end,:);

    T0 = zeros(35);
    T0([1,2,3,6,8,9,11,12,15,17,18,19,22,24,25,28,30,31,33,34,35],:) = -M(:,22:end);
    T0([319,355,392,605,783,819,856,1000,1036,1073,1111,1147,1184,1222]) = 1;
    T1 = zeros(35);
    T1([1,2,3,6,8,9,11,12,15,17,18,19,22,24,25,28,30,31,33,34,35],[1,2,3,6,8,9,11,12,15,17,18,19,22,24,25,28,30,31,33,34,35]) = M(:,1:21);
    T1([109,145,217,325,433,469,541,685,721,793,901,937,1009,1117]) = 1;

    [V,~] = eig(T0,T1);
    S = V(32:34,:)./repmat(V(35,:),3,1);
    S = S(:,all(isfinite(S)));

end