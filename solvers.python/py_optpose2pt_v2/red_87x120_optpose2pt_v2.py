import numpy as np
from scipy.sparse import csr_matrix
from scipy.linalg import lu, solve, eig

# Input: coefficient matrix C of size 6x21
# Output: solution matrix S of size 5x33

def red_87x120_optpose2pt_v2(C):
    M = csr_matrix((C.flat[[9,0,2,3,4,5,6,8,10,12,13,14,15,17,18,19,20,7,11,9,0,2,3,4,5,6,7,8,10,11,12,13,14,15,17,18,19,20,9,0,2,3,5,6,8,10,12,13,14,15,17,18,19,20,4,7,11,6,7,8,9,13,18,0,3,5,10,12,14,15,17,19,20,2,4,11,9,0,3,5,6,8,10,12,13,14,15,17,18,19,20,2,4,7,11,6,7,8,9,13,18,0,2,3,4,5,10,12,15,17,14,19,20,11,6,7,8,9,13,18,0,2,3,4,5,10,11,12,14,15,17,19,20,6,7,8,9,13,18,0,2,3,4,5,10,12,15,17,14,19,20,11,9,0,2,3,4,5,6,8,10,12,15,17,13,14,18,19,20,7,11,9,0,2,3,4,5,6,7,8,10,11,12,13,14,15,17,18,19,20,9,0,2,3,5,6,8,10,15,12,13,14,17,18,19,20,4,7,11,6,7,8,9,13,18,0,3,5,10,12,14,15,17,19,20,2,4,11,9,0,3,5,6,8,10,12,13,14,15,17,18,19,20,2,4,7,11,9,0,2,3,4,5,6,8,10,12,15,17,13,14,18,19,20,7,11,9,0,2,3,4,5,6,7,8,10,11,12,13,14,15,17,18,19,20,9,0,2,3,5,6,8,10,15,12,13,14,17,18,19,20,4,7,11,6,7,8,9,13,18,0,3,5,10,12,14,15,17,19,20,2,4,11,9,0,3,5,6,8,10,12,13,14,15,17,18,19,20,2,4,7,11,9,0,3,5,6,8,10,12,13,14,15,17,18,19,20,2,4,7,11,30,21,23,24,25,26,27,29,31,33,34,35,36,38,39,40,41,28,32,30,21,23,24,25,26,27,28,29,31,32,33,34,35,36,38,39,40,41,30,21,23,24,26,27,29,31,33,34,35,36,38,39,40,41,25,28,32,27,28,29,30,34,39,21,24,26,31,33,35,36,38,40,41,23,25,32,30,21,24,26,27,29,31,33,34,35,36,38,39,40,41,23,25,28,32,27,28,29,30,34,39,21,23,24,25,26,31,33,36,38,35,40,41,32,27,28,29,30,34,39,21,23,24,25,26,31,32,33,35,36,38,40,41,27,28,29,30,34,39,21,23,24,25,26,31,33,36,38,35,40,41,32,30,21,23,24,25,26,27,29,31,33,36,38,34,35,39,40,41,28,32,30,21,23,24,25,26,27,28,29,31,32,33,34,35,36,38,39,40,41,30,21,23,24,26,27,29,31,36,33,34,35,38,39,40,41,25,28,32,27,28,29,30,34,39,21,24,26,31,33,35,36,38,40,41,23,25,32,30,21,24,26,27,29,31,33,34,35,36,38,39,40,41,23,25,28,32,30,21,23,24,25,26,27,29,31,33,36,38,34,35,39,40,41,28,32,30,21,23,24,25,26,27,28,29,31,32,33,34,35,36,38,39,40,41,30,21,23,24,26,27,29,31,36,33,34,35,38,39,40,41,25,28,32,27,28,29,30,34,39,21,24,26,31,33,35,36,38,40,41,23,25,32,30,21,24,26,27,29,31,33,34,35,36,38,39,40,41,23,25,28,32,30,21,24,26,27,29,31,33,34,35,36,38,39,40,41,23,25,28,32,72,63,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,81,82,83,72,63,64,65,66,68,69,71,73,75,76,77,78,80,81,82,83,67,70,74,79,69,70,71,72,76,81,63,66,68,73,75,77,78,80,82,83,64,65,67,74,79,72,63,66,68,69,71,73,75,76,77,78,80,81,82,83,64,65,67,70,74,79,69,70,71,72,76,81,63,64,65,66,67,68,73,74,75,77,78,79,80,82,83,69,70,71,72,76,81,63,64,65,66,67,68,73,75,78,80,77,82,83,74,79,72,63,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,81,82,83,72,63,64,65,66,68,69,71,73,78,75,76,77,80,81,82,83,67,70,74,79,69,70,71,72,76,81,63,66,68,73,75,77,78,80,82,83,64,65,67,74,79,72,63,66,68,69,71,73,75,76,77,78,80,81,82,83,64,65,67,70,74,79,72,63,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,81,82,83,72,63,64,65,66,68,69,71,73,78,75,76,77,80,81,82,83,67,70,74,79,69,70,71,72,76,81,63,66,68,73,75,77,78,80,82,83,64,65,67,74,79,72,63,66,68,69,71,73,75,76,77,78,80,81,82,83,64,65,67,70,74,79,72,63,66,68,69,71,73,75,76,77,78,80,81,82,83,64,65,67,70,74,79,93,84,85,86,87,88,89,90,91,92,94,95,96,97,98,99,100,101,102,103,104,93,84,85,86,87,89,90,92,94,96,97,98,99,101,102,103,104,88,91,95,100,90,91,92,93,97,102,84,87,89,94,96,98,99,101,103,104,85,86,88,95,100,93,84,87,89,90,92,94,96,97,98,99,101,102,103,104,85,86,88,91,95,100,90,91,92,93,97,102,84,85,86,87,88,89,94,95,96,98,99,100,101,103,104,90,91,92,93,97,102,84,85,86,87,88,89,94,96,99,101,98,103,104,95,100,93,84,85,86,87,88,89,90,91,92,94,95,96,97,98,99,100,101,102,103,104,93,84,85,86,87,89,90,92,94,99,96,97,98,101,102,103,104,88,91,95,100,90,91,92,93,97,102,84,87,89,94,96,98,99,101,103,104,85,86,88,95,100,93,84,87,89,90,92,94,96,97,98,99,101,102,103,104,85,86,88,91,95,100,93,84,85,86,87,88,89,90,91,92,94,95,96,97,98,99,100,101,102,103,104,93,84,85,86,87,89,90,92,94,99,96,97,98,101,102,103,104,88,91,95,100,90,91,92,93,97,102,84,87,89,94,96,98,99,101,103,104,85,86,88,95,100,93,84,87,89,90,92,94,96,97,98,99,101,102,103,104,85,86,88,91,95,100,93,84,87,89,90,92,94,96,97,98,99,101,102,103,104,85,86,88,91,95,100,114,105,106,107,108,109,110,111,113,115,117,118,119,120,122,123,124,125,112,116,121,114,105,106,107,108,109,110,111,112,113,115,116,117,118,119,120,121,122,123,124,125,114,105,106,107,108,110,111,113,115,117,118,119,120,122,123,124,125,109,112,116,121,111,112,113,114,118,123,105,108,110,115,117,119,120,122,124,125,106,107,109,116,121,114,105,108,110,111,113,115,117,118,119,120,122,123,124,125,106,107,109,112,116,121,111,112,113,114,118,123,105,106,107,108,109,110,115,117,120,122,119,124,125,116,121,111,112,113,114,118,123,105,106,107,108,109,110,115,116,117,119,120,121,122,124,125,111,112,113,114,118,123,105,106,107,108,109,110,115,117,120,122,119,124,125,116,121,114,105,106,107,108,109,110,111,113,115,117,120,122,118,119,123,124,125,112,116,121,114,105,106,107,108,109,110,111,112,113,115,116,117,118,119,120,121,122,123,124,125,114,105,106,107,108,110,111,113,115,120,117,118,119,122,123,124,125,109,112,116,121,111,112,113,114,118,123,105,108,110,115,117,119,120,122,124,125,106,107,109,116,121,114,105,108,110,111,113,115,117,118,119,120,122,123,124,125,106,107,109,112,116,121,114,105,106,107,108,109,110,111,113,115,117,120,122,118,119,123,124,125,112,116,121,114,105,106,107,108,109,110,111,112,113,115,116,117,118,119,120,121,122,123,124,125,114,105,106,107,108,110,111,113,115,120,117,118,119,122,123,124,125,109,112,116,121,111,112,113,114,118,123,105,108,110,115,117,119,120,122,124,125,106,107,109,116,121,114,105,108,110,111,113,115,117,118,119,120,122,123,124,125,106,107,109,112,116,121,114,105,108,110,111,113,115,117,118,119,120,122,123,124,125,106,107,109,112,116,121]],([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86],[0,25,27,29,30,32,34,35,37,38,40,42,68,69,87,89,96,113,116,1,26,28,30,31,112,113,114,115,116,117,118,119,120,125,127,128,129,138,2,29,31,32,33,35,36,38,39,41,43,69,86,88,90,97,112,115,118,0,1,2,3,4,18,34,35,36,40,41,44,87,88,91,98,114,115,119,4,37,38,39,40,41,42,43,44,45,89,90,91,92,99,117,118,119,120,5,6,8,11,14,19,46,48,50,51,53,65,66,79,80,87,94,101,122,6,7,9,12,15,20,47,49,51,52,54,122,123,124,128,131,133,137,142,8,9,10,13,16,21,50,52,53,54,55,66,67,80,81,88,95,102,124,14,56,58,60,61,63,65,66,68,69,82,83,87,89,94,96,103,122,125,15,57,59,61,62,121,122,123,124,125,126,127,128,129,134,136,137,138,143,16,60,62,63,64,66,67,69,83,86,88,90,93,95,97,104,121,124,127,14,15,16,17,18,23,65,66,67,87,88,91,94,95,98,105,123,124,128,18,68,69,86,87,88,89,90,91,92,96,97,98,99,106,126,127,128,129,19,70,72,74,75,77,79,80,82,83,84,85,94,96,101,103,107,131,134,20,71,73,75,76,130,131,132,133,134,135,136,137,138,139,141,142,143,144,21,74,76,77,78,80,81,83,85,93,95,97,100,102,104,108,130,133,136,19,20,21,22,23,24,79,80,81,94,95,98,101,102,105,109,132,133,137,23,82,83,93,94,95,96,97,98,99,103,104,105,106,110,135,136,137,138,24,84,85,100,101,102,103,104,105,106,107,108,109,110,111,140,141,142,143,0,25,27,29,30,32,34,35,37,38,40,42,68,69,87,89,96,113,116,1,26,28,30,31,112,113,114,115,116,117,118,119,120,125,127,128,129,138,2,29,31,32,33,35,36,38,39,41,43,69,86,88,90,97,112,115,118,0,1,2,3,4,18,34,35,36,40,41,44,87,88,91,98,114,115,119,4,37,38,39,40,41,42,43,44,45,89,90,91,92,99,117,118,119,120,5,6,8,11,14,19,46,48,50,51,53,65,66,79,80,87,94,101,122,6,7,9,12,15,20,47,49,51,52,54,122,123,124,128,131,133,137,142,8,9,10,13,16,21,50,52,53,54,55,66,67,80,81,88,95,102,124,14,56,58,60,61,63,65,66,68,69,82,83,87,89,94,96,103,122,125,15,57,59,61,62,121,122,123,124,125,126,127,128,129,134,136,137,138,143,16,60,62,63,64,66,67,69,83,86,88,90,93,95,97,104,121,124,127,14,15,16,17,18,23,65,66,67,87,88,91,94,95,98,105,123,124,128,18,68,69,86,87,88,89,90,91,92,96,97,98,99,106,126,127,128,129,19,70,72,74,75,77,79,80,82,83,84,85,94,96,101,103,107,131,134,20,71,73,75,76,130,131,132,133,134,135,136,137,138,139,141,142,143,144,21,74,76,77,78,80,81,83,85,93,95,97,100,102,104,108,130,133,136,19,20,21,22,23,24,79,80,81,94,95,98,101,102,105,109,132,133,137,23,82,83,93,94,95,96,97,98,99,103,104,105,106,110,135,136,137,138,24,84,85,100,101,102,103,104,105,106,107,108,109,110,111,140,141,142,143,1,26,27,28,30,31,112,113,114,115,116,117,118,119,120,125,126,127,128,129,138,2,29,30,31,32,33,35,36,38,39,41,43,69,86,88,90,97,112,115,118,127,0,1,2,3,4,18,34,35,36,40,41,44,87,88,91,98,113,114,115,119,128,4,37,38,39,40,41,42,43,44,45,89,90,91,92,99,116,117,118,119,120,129,6,7,9,12,15,20,47,48,49,51,52,54,122,123,124,128,131,132,133,137,142,8,9,10,13,16,21,50,51,52,53,54,55,66,67,80,81,88,95,102,124,133,15,57,58,59,61,62,121,122,123,124,125,126,127,128,129,134,135,136,137,138,143,16,60,61,62,63,64,66,67,69,83,86,88,90,93,95,97,104,121,124,127,136,14,15,16,17,18,23,65,66,67,87,88,91,94,95,98,105,122,123,124,128,137,18,68,69,86,87,88,89,90,91,92,96,97,98,99,106,125,126,127,128,129,138,20,71,72,73,75,76,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,21,74,75,76,77,78,80,81,83,85,93,95,97,100,102,104,108,130,133,136,141,19,20,21,22,23,24,79,80,81,94,95,98,101,102,105,109,131,132,133,137,142,23,82,83,93,94,95,96,97,98,99,103,104,105,106,110,134,135,136,137,138,143,24,84,85,100,101,102,103,104,105,106,107,108,109,110,111,139,140,141,142,143,144,1,26,27,28,30,31,112,113,114,115,116,117,118,119,120,125,126,127,128,129,138,2,29,30,31,32,33,35,36,38,39,41,43,69,86,88,90,97,112,115,118,127,0,1,2,3,4,18,34,35,36,40,41,44,87,88,91,98,113,114,115,119,128,4,37,38,39,40,41,42,43,44,45,89,90,91,92,99,116,117,118,119,120,129,6,7,9,12,15,20,47,48,49,51,52,54,122,123,124,128,131,132,133,137,142,8,9,10,13,16,21,50,51,52,53,54,55,66,67,80,81,88,95,102,124,133,15,57,58,59,61,62,121,122,123,124,125,126,127,128,129,134,135,136,137,138,143,16,60,61,62,63,64,66,67,69,83,86,88,90,93,95,97,104,121,124,127,136,14,15,16,17,18,23,65,66,67,87,88,91,94,95,98,105,122,123,124,128,137,18,68,69,86,87,88,89,90,91,92,96,97,98,99,106,125,126,127,128,129,138,20,71,72,73,75,76,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,21,74,75,76,77,78,80,81,83,85,93,95,97,100,102,104,108,130,133,136,141,19,20,21,22,23,24,79,80,81,94,95,98,101,102,105,109,131,132,133,137,142,23,82,83,93,94,95,96,97,98,99,103,104,105,106,110,134,135,136,137,138,143,24,84,85,100,101,102,103,104,105,106,107,108,109,110,111,139,140,141,142,143,144,0,25,26,27,29,30,32,34,35,37,38,40,42,68,69,87,89,96,113,116,125,1,26,27,28,30,31,112,113,114,115,116,117,118,119,120,125,126,127,128,129,138,2,29,30,31,32,33,35,36,38,39,41,43,69,86,88,90,97,112,115,118,127,0,1,2,3,4,18,34,35,36,40,41,44,87,88,91,98,113,114,115,119,128,4,37,38,39,40,41,42,43,44,45,89,90,91,92,99,116,117,118,119,120,129,5,6,8,11,14,19,46,47,48,50,51,53,65,66,79,80,87,94,101,122,131,6,7,9,12,15,20,47,48,49,51,52,54,122,123,124,128,131,132,133,137,142,8,9,10,13,16,21,50,51,52,53,54,55,66,67,80,81,88,95,102,124,133,14,56,57,58,60,61,63,65,66,68,69,82,83,87,89,94,96,103,122,125,134,15,57,58,59,61,62,121,122,123,124,125,126,127,128,129,134,135,136,137,138,143,16,60,61,62,63,64,66,67,69,83,86,88,90,93,95,97,104,121,124,127,136,14,15,16,17,18,23,65,66,67,87,88,91,94,95,98,105,122,123,124,128,137,18,68,69,86,87,88,89,90,91,92,96,97,98,99,106,125,126,127,128,129,138,19,70,71,72,74,75,77,79,80,82,83,84,85,94,96,101,103,107,131,134,139,20,71,72,73,75,76,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,21,74,75,76,77,78,80,81,83,85,93,95,97,100,102,104,108,130,133,136,141,19,20,21,22,23,24,79,80,81,94,95,98,101,102,105,109,131,132,133,137,142,23,82,83,93,94,95,96,97,98,99,103,104,105,106,110,134,135,136,137,138,143,24,84,85,100,101,102,103,104,105,106,107,108,109,110,111,139,140,141,142,143,144])),shape=(87,145))

    M0 = csr_matrix(([1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1],([0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24],[17,71,95,113,18,72,19,73,20,74,43,59,100,114,101,115,44,60,102,116,61,75,62,76,103,117,63,77,64,78,104,118,65,79,66,80,67,81,71,82,113,119,72,83,73,84,74,85,81,86])),shape=(25,120))
    M = M[:,25:]-M[:,:25]@M0 # Schur complement reduction
    M = M.toarray()

    P,L,_ = lu(M[:,:61])
    M = solve(np.concatenate((P@L,P[:,61:]),axis=1),M[:,61:])
    M = M[-26:,:]

    T0 = np.zeros((33,33))
    T0[[0,1,3,4,6,7,8,9,10,12,13,15,16,17,18,19,21,22,24,25,26,27,29,30,31,32],:] = -M[:,26:]
    T0.flat[[82,182,388,488,690,790,956]] = 1
    T1 = np.zeros((33,33))
    T1[np.ix_([0,1,3,4,6,7,8,9,10,12,13,15,16,17,18,19,21,22,24,25,26,27,29,30,31,32],[0,1,3,4,6,7,8,9,10,12,13,15,16,17,18,19,21,22,24,25,26,27,29,30,31,32])] = M[:,:26]
    T1.flat[[68,170,374,476,680,782,952]] = 1

    _,V = eig(T0,T1)
    S = V[27:32,:]/np.tile(V[32,:],(5,1))
    S = S[:,np.all(np.isfinite(S),axis=0)]

    return S