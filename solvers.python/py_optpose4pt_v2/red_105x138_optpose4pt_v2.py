import numpy as np
from scipy.sparse import csr_matrix
from scipy.linalg import lu, solve, eig

# Input: coefficient matrix C of size 5x19
# Output: solution matrix S of size 5x33

def red_105x138_optpose4pt_v2(C):
    M = csr_matrix((C.flat[[5,6,7,8,12,16,0,2,3,4,9,10,11,13,14,15,17,18,5,6,7,8,12,16,0,2,3,4,9,10,13,14,15,18,17,11,5,6,7,8,12,16,0,1,2,3,4,9,14,15,10,11,13,17,18,8,0,2,3,4,5,6,7,9,10,12,13,14,15,16,18,17,11,8,0,2,3,4,5,6,9,10,12,13,14,15,18,16,17,7,11,8,0,1,2,3,4,5,14,15,6,7,9,10,11,12,13,16,17,18,5,6,7,8,12,16,0,1,2,9,10,13,14,17,18,3,4,11,15,8,0,1,5,6,9,10,12,13,14,16,17,18,2,3,4,7,11,15,8,0,2,4,5,6,7,9,10,11,12,14,16,17,13,18,3,15,8,0,4,5,6,7,9,10,11,16,17,12,13,14,18,2,3,15,8,0,1,2,3,4,5,6,7,9,10,11,14,15,12,13,16,17,18,5,6,7,8,12,16,0,1,2,3,4,9,10,13,14,17,18,11,15,5,6,7,8,12,16,0,1,2,3,4,9,14,10,13,17,18,11,15,5,6,7,8,12,16,0,1,2,3,4,9,10,11,13,14,15,17,18,8,0,1,2,3,4,5,6,9,12,13,14,10,16,17,18,7,11,15,8,0,1,2,3,4,5,14,6,9,10,12,13,16,17,18,7,11,15,8,0,1,2,3,4,5,6,7,9,10,11,12,13,14,15,16,17,18,5,6,7,8,12,16,0,9,13,1,10,14,17,18,2,3,4,11,15,8,0,5,9,12,13,1,6,10,14,16,17,18,2,3,4,7,11,15,8,0,2,4,5,6,9,10,14,1,12,13,16,17,18,3,7,11,15,8,0,4,5,6,9,10,1,12,13,14,16,17,18,2,3,7,11,15,8,0,2,3,4,1,5,6,7,9,10,11,12,13,14,15,16,17,18,5,6,7,8,12,16,0,1,9,10,13,14,17,18,2,3,4,11,15,8,0,1,5,6,9,10,12,13,14,16,17,18,2,3,4,7,11,15,8,0,1,5,6,9,10,12,13,14,16,17,18,2,3,4,7,11,15,24,25,26,27,31,35,19,21,22,23,28,29,30,32,33,34,36,37,24,25,26,27,31,35,19,21,22,23,28,29,32,33,34,37,36,30,24,25,26,27,31,35,19,20,21,22,23,28,33,34,29,30,32,36,37,27,19,21,22,23,24,25,26,28,29,31,32,33,34,35,37,36,30,27,19,21,22,23,24,25,28,29,31,32,33,34,37,35,36,26,30,27,19,20,21,22,23,24,33,34,25,26,28,29,30,31,32,35,36,37,24,25,26,27,31,35,19,20,21,28,29,32,33,36,37,22,23,30,34,27,19,20,24,25,28,29,31,32,33,35,36,37,21,22,23,26,30,34,27,19,21,23,24,25,26,28,29,30,31,33,35,36,32,37,22,34,27,19,23,24,25,26,28,29,30,35,36,31,32,33,37,21,22,34,27,19,21,22,23,24,25,26,28,29,30,34,20,31,32,33,35,36,37,27,19,20,21,22,23,24,25,26,28,29,30,33,34,31,32,35,36,37,24,25,26,27,31,35,19,20,21,22,23,28,29,32,33,36,37,30,34,24,25,26,27,31,35,19,20,21,22,23,28,33,29,32,36,37,30,34,24,25,26,27,31,35,19,20,21,22,23,28,29,30,32,33,34,36,37,27,19,20,21,22,23,24,25,28,31,32,33,29,35,36,37,26,30,34,27,19,20,21,22,23,24,33,25,28,29,31,32,35,36,37,26,30,34,27,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,36,37,24,25,26,27,31,35,19,28,32,20,29,33,36,37,21,22,23,30,34,27,19,24,28,31,32,20,25,29,33,35,36,37,21,22,23,26,30,34,27,19,21,23,24,25,28,29,33,20,31,32,35,36,37,22,26,30,34,27,19,23,24,25,28,29,20,31,32,33,35,36,37,21,22,26,30,34,27,19,21,22,23,20,24,25,26,28,29,30,31,32,33,34,35,36,37,24,25,26,27,31,35,19,20,28,29,32,33,36,37,21,22,23,30,34,27,19,20,24,25,28,29,31,32,33,35,36,37,21,22,23,26,30,34,27,19,20,24,25,28,29,31,32,33,35,36,37,21,22,23,26,30,34,43,44,45,46,50,54,38,40,41,42,47,48,49,51,52,53,55,56,43,44,45,46,50,54,38,40,41,42,47,48,51,52,53,56,55,49,43,44,45,46,50,54,38,39,40,41,42,47,52,53,48,49,51,55,56,46,38,40,41,42,43,44,45,47,48,50,51,52,53,54,56,55,49,46,38,40,41,42,43,44,47,48,50,51,52,53,56,54,55,45,49,46,38,39,40,41,42,43,52,53,44,45,47,48,49,50,51,54,55,56,43,44,45,46,50,54,38,39,40,47,48,51,52,55,56,41,42,49,53,46,38,39,43,44,47,48,50,51,52,54,55,56,40,41,42,45,49,53,46,38,40,42,43,44,45,47,48,49,50,52,54,55,51,56,41,53,46,38,42,43,44,45,47,48,49,54,55,50,51,52,56,40,41,53,46,38,40,41,42,43,44,45,47,48,49,52,53,39,50,51,54,55,56,46,38,40,41,42,43,44,45,47,48,49,53,39,50,51,52,54,55,56,46,38,39,40,41,42,43,44,45,47,48,49,52,53,50,51,54,55,56,43,44,45,46,50,54,38,39,40,41,42,47,48,51,52,55,56,49,53,43,44,45,46,50,54,38,39,40,41,42,47,52,48,51,55,56,49,53,43,44,45,46,50,54,38,39,40,41,42,47,48,49,51,52,53,55,56,46,38,39,40,41,42,43,44,47,50,51,52,48,54,55,56,45,49,53,46,38,39,40,41,42,43,52,44,47,48,50,51,54,55,56,45,49,53,46,38,39,40,41,42,43,44,45,47,48,49,50,51,52,53,54,55,56,43,44,45,46,50,54,38,47,51,39,48,52,55,56,40,41,42,49,53,46,38,43,47,50,51,39,44,48,52,54,55,56,40,41,42,45,49,53,46,38,40,42,43,44,47,48,52,39,50,51,54,55,56,41,45,49,53,46,38,42,43,44,47,48,39,50,51,52,54,55,56,40,41,45,49,53,46,38,40,41,42,39,43,44,45,47,48,49,50,51,52,53,54,55,56,43,44,45,46,50,54,38,39,47,48,51,52,55,56,40,41,42,49,53,46,38,39,43,44,47,48,50,51,52,54,55,56,40,41,42,45,49,53,46,38,39,43,44,47,48,50,51,52,54,55,56,40,41,42,45,49,53,62,63,64,65,69,73,57,59,60,61,66,67,68,70,71,72,74,75,62,63,64,65,69,73,57,59,60,61,66,67,70,71,72,75,74,68,62,63,64,65,69,73,57,58,59,60,61,66,71,72,67,68,70,74,75,65,57,59,60,61,62,63,64,66,67,69,70,71,72,73,75,74,68,65,57,59,60,61,62,63,66,67,69,70,71,72,75,73,74,64,68,65,57,58,59,60,61,62,71,72,63,64,66,67,68,69,70,73,74,75,62,63,64,65,69,73,57,58,59,66,67,70,71,74,75,60,61,68,72,65,57,58,62,63,66,67,69,70,71,73,74,75,59,60,61,64,68,72,65,57,59,61,62,63,64,66,67,68,69,71,73,74,70,75,60,72,65,57,61,62,63,64,66,67,68,73,74,69,70,71,75,59,60,72,65,57,59,60,61,62,63,64,66,67,68,71,72,58,69,70,73,74,75,65,57,59,60,61,62,63,64,66,67,68,72,58,69,70,71,73,74,75,65,57,58,59,60,61,62,63,64,66,67,68,71,72,69,70,73,74,75,62,63,64,65,69,73,57,58,59,60,61,66,67,70,71,74,75,68,72,62,63,64,65,69,73,57,58,59,60,61,66,71,67,70,74,75,68,72,62,63,64,65,69,73,57,58,59,60,61,66,67,68,70,71,72,74,75,65,57,58,59,60,61,62,63,66,69,70,71,67,73,74,75,64,68,72,65,57,58,59,60,61,62,71,63,66,67,69,70,73,74,75,64,68,72,65,57,58,59,60,61,62,63,64,66,67,68,69,70,71,72,73,74,75,62,63,64,65,69,73,57,66,70,58,67,71,74,75,59,60,61,68,72,65,57,62,66,69,70,58,63,67,71,73,74,75,59,60,61,64,68,72,65,57,59,61,62,63,66,67,71,58,69,70,73,74,75,60,64,68,72,65,57,61,62,63,66,67,58,69,70,71,73,74,75,59,60,64,68,72,65,57,59,60,61,58,62,63,64,66,67,68,69,70,71,72,73,74,75,62,63,64,65,69,73,57,58,66,67,70,71,74,75,59,60,61,68,72,65,57,58,62,63,66,67,69,70,71,73,74,75,59,60,61,64,68,72,65,57,58,62,63,66,67,69,70,71,73,74,75,59,60,61,64,68,72]],([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104],[0,1,3,6,9,15,34,36,37,39,50,51,53,57,74,78,94,107,1,2,4,7,10,16,35,37,38,40,51,52,58,75,79,108,113,139,3,4,5,8,11,18,36,38,39,40,41,53,78,81,139,140,144,149,159,9,42,44,45,47,50,51,53,54,55,57,59,84,88,94,110,114,141,10,43,45,46,48,51,52,55,56,58,60,85,89,111,113,115,139,142,11,44,46,47,48,49,53,88,91,139,140,141,142,143,144,145,149,152,162,9,10,11,12,13,24,50,52,53,57,58,61,94,116,121,139,140,144,149,13,54,56,57,58,59,60,61,62,114,116,117,123,141,142,143,144,145,152,15,63,66,68,74,75,78,84,85,88,94,101,107,110,114,126,146,156,16,64,69,75,76,79,85,86,89,108,111,113,115,118,127,146,147,157,19,67,69,70,71,72,80,81,82,90,91,92,103,105,150,153,160,163,168,14,15,17,20,23,28,73,75,77,78,80,93,94,96,106,120,128,148,158,15,16,18,21,24,29,74,76,78,79,81,94,107,113,116,121,129,149,159,17,18,19,22,25,30,77,79,80,81,82,148,149,150,154,158,160,164,169,23,83,85,87,88,90,93,94,95,96,97,109,114,120,122,130,148,151,161,24,84,86,88,89,91,94,110,113,114,115,116,117,121,123,131,149,152,162,25,87,89,90,91,92,148,149,150,151,152,153,154,155,161,163,164,165,170,23,24,25,26,27,32,93,96,98,113,116,120,124,132,148,149,150,154,164,27,95,96,97,98,99,115,116,117,122,124,125,133,151,152,153,154,155,165,28,100,102,103,106,107,109,110,112,118,120,122,128,130,134,156,158,161,166,29,101,104,107,108,110,111,119,121,123,126,129,131,135,156,157,159,162,167,30,102,103,104,105,157,158,159,160,161,162,163,164,165,166,168,169,170,171,28,29,30,31,32,33,106,108,120,121,124,128,132,136,158,159,160,164,169,32,109,111,120,121,122,123,124,125,130,132,133,137,161,162,163,164,165,170,33,112,127,128,129,130,131,132,133,134,136,137,138,166,167,168,169,170,171,0,1,3,6,9,15,34,36,37,39,50,51,53,57,74,78,94,107,1,2,4,7,10,16,35,37,38,40,51,52,58,75,79,108,113,139,3,4,5,8,11,18,36,38,39,40,41,53,78,81,139,140,144,149,159,9,42,44,45,47,50,51,53,54,55,57,59,84,88,94,110,114,141,10,43,45,46,48,51,52,55,56,58,60,85,89,111,113,115,139,142,11,44,46,47,48,49,53,88,91,139,140,141,142,143,144,145,149,152,162,9,10,11,12,13,24,50,52,53,57,58,61,94,116,121,139,140,144,149,13,54,56,57,58,59,60,61,62,114,116,117,123,141,142,143,144,145,152,15,63,66,68,74,75,78,84,85,88,94,101,107,110,114,126,146,156,16,64,69,75,76,79,85,86,89,108,111,113,115,118,127,146,147,157,18,66,68,69,71,78,79,81,88,89,91,104,147,149,152,156,159,162,167,19,67,69,70,71,72,80,81,82,90,91,92,103,105,150,153,160,163,168,14,15,17,20,23,28,73,75,77,78,80,93,94,96,106,120,128,148,158,15,16,18,21,24,29,74,76,78,79,81,94,107,113,116,121,129,149,159,17,18,19,22,25,30,77,79,80,81,82,148,149,150,154,158,160,164,169,23,83,85,87,88,90,93,94,95,96,97,109,114,120,122,130,148,151,161,24,84,86,88,89,91,94,110,113,114,115,116,117,121,123,131,149,152,162,25,87,89,90,91,92,148,149,150,151,152,153,154,155,161,163,164,165,170,23,24,25,26,27,32,93,96,98,113,116,120,124,132,148,149,150,154,164,27,95,96,97,98,99,115,116,117,122,124,125,133,151,152,153,154,155,165,28,100,102,103,106,107,109,110,112,118,120,122,128,130,134,156,158,161,166,29,101,104,107,108,110,111,119,121,123,126,129,131,135,156,157,159,162,167,30,102,103,104,105,157,158,159,160,161,162,163,164,165,166,168,169,170,171,28,29,30,31,32,33,106,108,120,121,124,128,132,136,158,159,160,164,169,32,109,111,120,121,122,123,124,125,130,132,133,137,161,162,163,164,165,170,33,112,127,128,129,130,131,132,133,134,136,137,138,166,167,168,169,170,171,0,1,3,6,9,15,34,36,37,39,50,51,53,57,74,78,94,107,1,2,4,7,10,16,35,37,38,40,51,52,58,75,79,108,113,139,3,4,5,8,11,18,36,38,39,40,41,53,78,81,139,140,144,149,159,9,42,44,45,47,50,51,53,54,55,57,59,84,88,94,110,114,141,10,43,45,46,48,51,52,55,56,58,60,85,89,111,113,115,139,142,11,44,46,47,48,49,53,88,91,139,140,141,142,143,144,145,149,152,162,9,10,11,12,13,24,50,52,53,57,58,61,94,116,121,139,140,144,149,13,54,56,57,58,59,60,61,62,114,116,117,123,141,142,143,144,145,152,15,63,66,68,74,75,78,84,85,88,94,101,107,110,114,126,146,156,16,64,69,75,76,79,85,86,89,108,111,113,115,118,127,146,147,157,17,65,67,68,70,77,78,80,87,88,90,102,103,146,148,151,158,161,166,18,66,68,69,71,78,79,81,88,89,91,104,147,149,152,156,159,162,167,19,67,69,70,71,72,80,81,82,90,91,92,103,105,150,153,160,163,168,14,15,17,20,23,28,73,75,77,78,80,93,94,96,106,120,128,148,158,15,16,18,21,24,29,74,76,78,79,81,94,107,113,116,121,129,149,159,17,18,19,22,25,30,77,79,80,81,82,148,149,150,154,158,160,164,169,23,83,85,87,88,90,93,94,95,96,97,109,114,120,122,130,148,151,161,24,84,86,88,89,91,94,110,113,114,115,116,117,121,123,131,149,152,162,25,87,89,90,91,92,148,149,150,151,152,153,154,155,161,163,164,165,170,23,24,25,26,27,32,93,96,98,113,116,120,124,132,148,149,150,154,164,27,95,96,97,98,99,115,116,117,122,124,125,133,151,152,153,154,155,165,28,100,102,103,106,107,109,110,112,118,120,122,128,130,134,156,158,161,166,29,101,104,107,108,110,111,119,121,123,126,129,131,135,156,157,159,162,167,30,102,103,104,105,157,158,159,160,161,162,163,164,165,166,168,169,170,171,28,29,30,31,32,33,106,108,120,121,124,128,132,136,158,159,160,164,169,32,109,111,120,121,122,123,124,125,130,132,133,137,161,162,163,164,165,170,33,112,127,128,129,130,131,132,133,134,136,137,138,166,167,168,169,170,171,0,1,3,6,9,15,34,36,37,39,50,51,53,57,74,78,94,107,1,2,4,7,10,16,35,37,38,40,51,52,58,75,79,108,113,139,3,4,5,8,11,18,36,38,39,40,41,53,78,81,139,140,144,149,159,9,42,44,45,47,50,51,53,54,55,57,59,84,88,94,110,114,141,10,43,45,46,48,51,52,55,56,58,60,85,89,111,113,115,139,142,11,44,46,47,48,49,53,88,91,139,140,141,142,143,144,145,149,152,162,9,10,11,12,13,24,50,52,53,57,58,61,94,116,121,139,140,144,149,13,54,56,57,58,59,60,61,62,114,116,117,123,141,142,143,144,145,152,15,63,66,68,74,75,78,84,85,88,94,101,107,110,114,126,146,156,16,64,69,75,76,79,85,86,89,108,111,113,115,118,127,146,147,157,17,65,67,68,70,77,78,80,87,88,90,102,103,146,148,151,158,161,166,18,66,68,69,71,78,79,81,88,89,91,104,147,149,152,156,159,162,167,19,67,69,70,71,72,80,81,82,90,91,92,103,105,150,153,160,163,168,14,15,17,20,23,28,73,75,77,78,80,93,94,96,106,120,128,148,158,15,16,18,21,24,29,74,76,78,79,81,94,107,113,116,121,129,149,159,17,18,19,22,25,30,77,79,80,81,82,148,149,150,154,158,160,164,169,23,83,85,87,88,90,93,94,95,96,97,109,114,120,122,130,148,151,161,24,84,86,88,89,91,94,110,113,114,115,116,117,121,123,131,149,152,162,25,87,89,90,91,92,148,149,150,151,152,153,154,155,161,163,164,165,170,23,24,25,26,27,32,93,96,98,113,116,120,124,132,148,149,150,154,164,27,95,96,97,98,99,115,116,117,122,124,125,133,151,152,153,154,155,165,28,100,102,103,106,107,109,110,112,118,120,122,128,130,134,156,158,161,166,29,101,104,107,108,110,111,119,121,123,126,129,131,135,156,157,159,162,167,30,102,103,104,105,157,158,159,160,161,162,163,164,165,166,168,169,170,171,28,29,30,31,32,33,106,108,120,121,124,128,132,136,158,159,160,164,169,32,109,111,120,121,122,123,124,125,130,132,133,137,161,162,163,164,165,170,33,112,127,128,129,130,131,132,133,134,136,137,138,166,167,168,169,170,171])),shape=(105,172))

    M0 = csr_matrix((np.array([1,-1,1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1]),([0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33],[20,67,21,84,22,85,107,122,108,123,70,109,23,73,24,74,110,125,25,76,26,77,111,128,27,87,28,89,61,78,80,92,81,93,117,132,118,133,119,134,62,94,82,95,120,135,63,96,83,97,121,136,64,98,65,99,88,100,89,101,131,137,90,102,91,103,99,104])),shape=(34,138))
    M = M[:,34:]-M[:,:34]@M0 # Schur complement reduction
    M = M.toarray()

    P,L,_ = lu(M[:,:79])
    M = solve(np.concatenate((P@L,P[:,79:]),axis=1),M[:,79:])
    M = M[-26:,:]

    T0 = np.zeros((33,33))
    T0[[0,2,3,5,6,7,8,9,10,12,13,15,16,17,18,19,20,22,23,25,26,27,28,30,31,32],:] = -M[:,26:]
    T0.flat[[43,145,388,488,723,823,989]] = 1
    T1 = np.zeros((33,33))
    T1[np.ix_([0,2,3,5,6,7,8,9,10,12,13,15,16,17,18,19,20,22,23,25,26,27,28,30,31,32],[0,2,3,5,6,7,8,9,10,12,13,15,16,17,18,19,20,22,23,25,26,27,28,30,31,32])] = M[:,:26]
    T1.flat[[34,136,374,476,714,816,986]] = 1

    _,V = eig(T0,T1)
    S = V[27:32,:]/np.tile(V[32,:],(5,1))
    S = S[:,np.all(np.isfinite(S),axis=0)]

    return S