# Input: coefficient matrix C of size 4x52
# Output: solution matrix S of size 4x24

function red_73x97_rdist9p(C::Array{Float64})

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73],[3,5,10,11,13,18,20,28,29,33,75,79,4,6,12,13,14,19,21,34,74,75,76,81,7,10,22,25,28,37,38,41,44,51,8,11,26,29,38,39,42,45,52,9,12,23,27,40,41,55,58,74,78,10,13,28,41,42,56,59,75,79,12,14,55,56,57,61,74,76,81,16,18,25,26,28,31,33,44,45,47,79,86,17,19,27,28,32,34,48,74,78,79,81,88,18,20,28,29,33,35,49,75,79,80,82,89,19,21,34,74,75,76,77,81,82,83,84,90,24,27,36,37,40,43,50,51,58,64,78,85,25,28,37,38,41,44,51,52,59,65,79,86,26,29,38,39,42,45,52,53,60,66,80,87,27,40,41,55,58,59,61,67,74,78,81,88,28,41,42,56,59,60,62,68,75,79,82,89,55,56,57,61,62,63,69,74,76,81,83,90,30,32,43,44,46,48,54,78,85,86,88,93,31,33,44,45,47,49,79,86,87,89,91,94,32,34,48,78,79,81,84,88,89,90,92,95,43,50,51,58,64,65,67,70,78,85,88,93,44,51,52,59,65,66,68,71,79,86,89,94,58,59,61,67,68,69,72,78,81,88,90,95,46,48,54,85,86,88,92,93,94,95,96,97,64,65,67,70,71,72,73,85,88,93,95,97,1,3,7,8,10,16,18,25,26,28,31,44,2,4,9,10,12,17,19,27,28,32,74,78,3,5,10,11,13,18,20,28,29,33,75,79,4,6,12,13,14,19,21,34,74,75,76,81,7,10,22,25,28,37,38,41,44,51,8,11,26,29,38,39,42,45,52,9,12,23,27,40,41,55,58,74,78,10,13,28,41,42,56,59,75,79,12,14,55,56,57,61,74,76,81,15,17,24,25,27,30,32,43,44,46,78,85,16,18,25,26,28,31,33,44,45,47,79,86,17,19,27,28,32,34,48,74,78,79,81,88,18,20,28,29,33,35,49,75,79,80,82,89,19,21,34,74,75,76,77,81,82,83,84,90,24,27,36,37,40,43,50,51,58,64,78,85,25,28,37,38,41,44,51,52,59,65,79,86,26,29,38,39,42,45,52,53,60,66,80,87,27,40,41,55,58,59,61,67,74,78,81,88,28,41,42,56,59,60,62,68,75,79,82,89,55,56,57,61,62,63,69,74,76,81,83,90,30,32,43,44,46,48,54,78,85,86,88,93,31,33,44,45,47,49,79,86,87,89,91,94,32,34,48,78,79,81,84,88,89,90,92,95,43,50,51,58,64,65,67,70,78,85,88,93,44,51,52,59,65,66,68,71,79,86,89,94,58,59,61,67,68,69,72,78,81,88,90,95,46,48,54,85,86,88,92,93,94,95,96,97,64,65,67,70,71,72,73,85,88,93,95,97,25,26,28,37,38,41,44,51,27,28,40,41,55,58,74,78,28,29,41,42,56,59,75,79,55,56,57,61,74,75,76,81,34,35,77,81,82,83,84,90,43,44,50,51,58,64,78,85,44,45,51,52,59,65,79,86,58,59,61,67,78,79,81,88,59,60,62,68,79,80,82,89,61,62,63,69,81,82,83,90,46,47,48,54,85,86,88,93,48,49,84,88,89,90,92,95,64,65,67,70,85,86,88,93,65,66,68,71,86,87,89,94,67,68,69,72,88,89,90,95,54,91,92,93,94,95,96,97,70,71,72,73,93,94,95,97,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,22,23,24,25,26,27,28,30,31,32,36,37,38,40,41,43,44,46,50,51,55,58,64,74,78,85,16,17,18,19,20,21,25,26,27,28,29,30,31,32,33,34,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,54,55,56,57,58,59,61,64,65,67,70,74,75,76,78,79,81,85,86,88,93,31,32,33,34,35,44,45,46,47,48,49,51,52,53,54,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97],C[[113,125,149,153,161,173,181,189,193,201,197,205,113,125,149,153,161,173,181,201,189,193,197,205,113,125,149,173,181,189,193,197,201,205,113,125,173,181,189,193,197,201,205,113,125,149,173,189,193,197,205,181,201,113,125,173,189,193,197,205,181,201,113,125,189,193,197,205,173,181,201,113,125,149,153,161,173,181,189,193,201,197,205,113,125,149,153,173,181,201,161,189,193,197,205,113,125,149,153,173,181,201,161,189,193,197,205,113,125,173,149,153,161,181,189,193,197,201,205,113,125,149,153,161,173,189,193,197,205,181,201,113,125,149,153,161,173,189,193,197,205,181,201,113,125,149,153,161,173,189,193,197,205,181,201,113,149,153,161,189,193,197,205,125,173,181,201,113,149,153,161,189,193,197,205,125,173,181,201,149,153,161,189,193,197,205,113,125,173,181,201,113,125,149,153,173,181,201,161,189,193,197,205,113,125,149,153,173,181,161,189,193,197,201,205,113,125,173,149,153,161,181,189,193,197,201,205,113,149,153,161,189,193,197,205,125,173,181,201,113,149,153,161,189,193,197,205,125,173,181,201,149,153,161,189,193,197,205,113,125,173,181,201,113,125,173,149,153,161,181,189,193,197,201,205,149,153,161,189,193,197,205,113,125,173,181,201,114,126,150,154,162,174,182,190,194,198,202,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,162,174,182,202,190,194,198,206,114,126,150,174,182,190,194,198,202,206,114,126,174,182,190,194,198,202,206,114,126,150,174,190,194,198,206,182,202,114,126,174,190,194,198,206,182,202,114,126,190,194,198,206,174,182,202,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,174,182,202,162,190,194,198,206,114,126,150,154,174,182,202,162,190,194,198,206,114,126,174,150,154,162,182,190,194,198,202,206,114,126,150,154,162,174,190,194,198,206,182,202,114,126,150,154,162,174,190,194,198,206,182,202,114,126,150,154,162,174,190,194,198,206,182,202,114,150,154,162,190,194,198,206,126,174,182,202,114,150,154,162,190,194,198,206,126,174,182,202,150,154,162,190,194,198,206,114,126,174,182,202,114,126,150,154,174,182,202,162,190,194,198,206,114,126,150,154,174,182,162,190,194,198,202,206,114,126,174,150,154,162,182,190,194,198,202,206,114,150,154,162,190,194,198,206,126,174,182,202,114,150,154,162,190,194,198,206,126,174,182,202,150,154,162,190,194,198,206,114,126,174,182,202,114,126,174,150,154,162,182,190,194,198,202,206,150,154,162,190,194,198,206,114,126,174,182,202,175,179,183,191,195,199,203,207,175,179,191,195,199,207,183,203,175,179,191,195,199,207,183,203,191,195,199,207,175,179,183,203,175,179,183,191,195,199,203,207,175,179,191,195,199,207,183,203,175,179,191,195,199,207,183,203,191,195,199,207,175,179,183,203,191,195,199,207,175,179,183,203,191,195,199,207,175,179,183,203,175,179,183,203,191,195,199,207,175,179,183,191,195,199,203,207,191,195,199,207,175,179,183,203,191,195,199,207,175,179,183,203,191,195,199,207,175,179,183,203,175,179,183,191,195,199,203,207,191,195,199,207,175,179,183,203,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,92,116,120,124,128,132,140,144,148,152,156,160,164,168,176,180,188,192,196,172,200,208,136,184,204,4,8,12,16,20,24,28,32,36,40,44,60,64,68,72,76,80,84,88,92,96,100,116,120,124,140,144,148,152,156,160,188,104,108,112,164,168,172,192,196,200,208,48,52,56,128,132,136,176,180,184,204,4,8,12,16,20,28,32,60,64,68,72,80,84,88,140,92,96,100,104,108,112,152,156,160,164,168,172,192,196,200,208,24,36,40,44,48,52,56,76,116,120,124,128,132,136,144,148,176,180,184,188,204]],73,97)
    M = Matrix(M)

    L,_,p = lu(M[:,1:54])
    Id = Matrix{Float64}(I,73,73)
    M = [L Id[:,55:end]][invperm(p),:]\M[:,55:end]
    M = M[end-18:end,:]

    T0 = zeros(24,24)
    T0[[1,2,3,5,6,7,8,9,10,12,13,14,15,16,17,20,21,22,24],:] = -M[:,20:end]
    T0[[220,395,498,523,575]] .= 1
    T1 = zeros(24,24)
    T1[[1,2,3,5,6,7,8,9,10,12,13,14,15,16,17,20,21,22,24],[1,2,3,5,6,7,8,9,10,12,13,14,15,16,17,20,21,22,24]] = M[:,1:19]
    T1[[76,251,426,451,551]] .= 1

    _,V = eigen(T0,T1)
    S = V[20:23,:]./repeat(V[24:24,:],4)
    S = S[:,vec(all(c -> !isinf(c) && !isnan(c), S; dims=1))]

    return S

end