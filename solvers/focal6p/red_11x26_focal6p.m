% Input: coefficient matrix C of size 10x26
% Output: solution matrix S of size 3x15

function S = red_11x26_focal6p(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11],[1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,3,4,6,7,8,9,10,11,16,17,18,19,20,21,22,24,25,26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,1,2,3,4,6,7,8,9,10,11,13,16,18,19,20,21,24,25,26,1,2,3,4,5,6,7,8,9,10,11,13,14,16,17,18,19,20,21,22,24,25,26,1,2,3,4,5,6,7,8,9,10,11,13,14,16,17,18,19,20,21,22,24,25,26,2,3,4,5,6,7,8,9,10,11,14,16,18,19,24,25,26,2,3,4,5,6,7,8,9,10,11,1,16,18,19,20,21,22,24,25,26],C([31,101,131,151,161,181,201,211,231,241,251,11,21,41,51,61,71,81,91,171,221,111,121,141,191,32,102,132,152,162,182,202,212,232,242,252,12,22,42,52,62,72,82,92,172,222,112,122,142,192,103,133,153,183,203,213,233,243,253,53,63,73,83,93,173,223,123,143,193,34,104,134,154,164,184,204,214,234,244,254,4,14,24,44,54,64,74,84,94,174,224,124,144,194,35,105,135,155,165,185,205,215,235,245,255,5,15,25,45,55,65,75,85,95,175,225,125,145,195,36,106,136,156,186,206,216,236,246,256,16,56,76,86,96,176,126,146,196,37,107,137,157,167,187,207,217,237,247,257,17,27,57,67,77,87,97,177,227,127,147,197,38,108,138,158,168,188,208,218,238,248,258,18,28,58,68,78,88,98,178,228,128,148,198,109,139,159,169,189,209,219,239,249,259,29,59,79,89,129,149,199,110,140,160,170,190,210,220,240,250,260,110,140,160,170,190,240,260,210,220,250]),11,26);

    [L,~,P] = lu(M(:,1:2));
    P = P';
    M = [P*L P(:,3:end)]\M(:,3:end);
    M = M(end-8:end,:);

    T0 = zeros(15);
    T0([5,7,8,9,13,14,10,15,11],:) = -M(:,10:end);
    T0([61,92,108,184,201,222]) = 1;
    T1 = zeros(15);
    T1([5,7,8,9,13,14,10,15,11],[5,7,8,9,13,14,10,15,11]) = M(:,1:9);
    T1([1,17,33,49,81,177]) = 1;

    [V,~] = eig(T0,T1);
    S = V(12:14,:)./repmat(V(15,:),3,1);

    I = ~any(isnan(S)) & ~any(isinf(S));
    %I = I & ~any(imag(S)); % uncomment this line for real roots only
    S = S(:,I);

end