% Input: coefficient matrix C of size 11x95
% Output: solution matrix S of size 4x56

function S = red_39x95_relpose_6p_rad(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39],[36,37,38,39,87,88,89,90,91,92,93,94,95,19,30,31,33,36,72,73,75,81,82,84,87,91,31,32,34,37,73,74,76,78,82,83,85,88,92,33,34,35,38,75,76,77,79,84,85,86,89,93,19,78,79,80,87,88,89,90,91,92,93,94,95,13,15,20,21,24,30,48,50,62,63,66,72,81,14,22,23,26,32,49,52,56,64,65,68,74,83,27,28,29,35,53,54,55,58,69,70,71,77,86,18,19,59,60,61,78,79,80,87,88,89,90,94,12,18,19,45,46,47,59,60,61,78,79,80,90,13,14,16,21,22,25,31,51,63,64,67,73,82,15,16,17,18,19,72,73,75,81,82,84,87,91,1,2,5,9,13,15,48,50,62,63,66,72,81,25,26,28,34,51,52,54,57,67,68,70,76,85,16,56,57,59,73,74,76,78,82,83,85,88,92,10,16,42,43,45,56,57,59,73,74,76,78,88,3,4,7,14,42,49,52,56,64,65,68,74,83,17,24,25,27,33,50,51,53,66,67,69,75,84,17,57,58,60,75,76,77,79,84,85,86,89,93,11,17,43,44,46,57,58,60,75,76,77,79,89,8,40,41,44,53,54,55,58,69,70,71,77,86,9,10,11,12,15,16,17,18,19,72,73,75,87,2,3,6,10,13,14,16,51,63,64,67,73,82,6,7,40,43,51,52,54,57,67,68,70,76,85,5,6,8,11,17,50,51,53,66,67,69,75,84,13,14,16,17,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,49,50,51,52,53,54,55,56,57,58,59,60,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,2,3,4,5,6,7,8,10,11,13,14,15,16,17,18,19,40,41,42,43,44,45,46,49,50,51,52,53,54,55,56,57,58,59,60,61,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,13,14,16,17,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,49,50,51,52,53,54,55,56,57,58,59,60,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,2,3,4,5,6,7,8,10,11,13,14,15,16,17,18,19,40,41,42,43,44,45,46,49,50,51,52,53,54,55,56,57,58,59,60,61,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,13,14,16,17,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,49,50,51,52,53,54,55,56,57,58,59,60,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,2,3,4,5,6,7,8,10,11,13,14,15,16,17,18,19,40,41,42,43,44,45,46,49,50,51,52,53,54,55,56,57,58,59,60,61,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,13,14,16,17,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,49,50,51,52,53,54,55,56,57,58,59,60,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,2,3,4,5,6,7,8,10,11,13,14,15,16,17,18,19,40,41,42,43,44,45,46,49,50,51,52,53,54,55,56,57,58,59,60,61,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95],C([991,1002,1013,1035,837,848,859,870,947,958,969,980,1024,870,991,1002,1013,1035,837,848,859,947,958,969,980,1024,991,1002,1013,1035,837,848,859,870,947,958,969,980,1024,991,1002,1013,1035,837,848,859,870,947,958,969,980,1024,837,848,859,870,947,958,969,980,991,1002,1013,1024,1035,848,870,991,1002,1013,1035,837,859,947,958,969,980,1024,837,991,1002,1013,1035,848,859,870,947,958,969,980,1024,991,1002,1013,1035,837,848,859,870,947,958,969,980,1024,837,947,848,859,870,958,969,980,991,1002,1013,1024,1035,837,947,991,848,859,870,958,969,980,1002,1013,1024,1035,837,848,870,991,1002,1013,1035,859,947,958,969,980,1024,837,848,859,870,980,947,958,969,991,1002,1013,1024,1035,837,848,859,870,958,980,947,969,991,1002,1013,1024,1035,991,1002,1013,1035,837,848,859,870,947,958,969,980,1024,837,848,859,870,947,958,969,980,991,1002,1013,1024,1035,837,947,848,859,870,958,969,980,991,1002,1013,1024,1035,837,848,859,947,870,958,969,980,991,1002,1013,1024,1035,870,991,1002,1013,1035,837,848,859,947,958,969,980,1024,837,848,859,870,947,958,969,980,991,1002,1013,1024,1035,837,947,848,859,870,958,969,980,991,1002,1013,1024,1035,837,848,859,870,947,958,969,980,991,1002,1013,1024,1035,837,848,859,870,947,958,969,980,1024,991,1002,1013,1035,837,848,859,870,947,958,980,969,991,1002,1013,1024,1035,837,848,859,870,947,958,969,980,991,1002,1013,1024,1035,837,848,859,870,980,947,958,969,991,1002,1013,1024,1035,233,244,343,365,618,673,684,695,706,717,728,739,750,761,882,893,904,915,926,937,992,1003,1014,1036,255,266,277,288,299,310,321,354,376,387,409,420,453,464,475,486,497,508,519,530,541,552,563,574,585,596,607,629,640,651,772,783,794,805,816,827,838,849,860,871,948,959,970,981,1025,233,244,255,266,277,288,299,343,365,453,464,552,563,585,618,838,310,321,354,376,387,409,420,475,486,497,508,519,530,541,574,596,607,629,640,651,673,684,695,706,717,728,739,750,761,772,783,794,805,816,827,849,860,871,882,893,904,915,926,937,948,959,970,981,992,1003,1014,1025,1036,3,14,25,36,47,58,69,80,113,124,146,179,234,245,333,344,366,399,619,663,674,685,696,707,718,729,740,751,762,883,894,905,916,927,938,993,1004,1015,1037,91,102,135,157,168,190,201,212,223,256,267,278,289,300,311,322,355,377,388,410,421,432,443,454,465,476,487,498,509,520,531,542,553,564,575,586,597,608,630,641,652,773,784,795,806,817,828,839,850,861,872,949,960,971,982,1026,4,15,26,37,48,59,70,81,114,125,147,180,235,246,334,345,367,400,620,664,675,686,697,708,719,730,741,752,763,884,895,906,917,928,939,994,1005,1016,1038,92,103,136,158,169,191,202,213,224,257,268,279,290,301,312,323,356,378,389,411,422,433,444,455,466,477,488,499,510,521,532,543,554,565,576,587,598,609,631,642,653,774,785,796,807,818,829,840,851,862,873,950,961,972,983,1027,5,16,27,38,49,60,71,82,115,126,148,181,236,247,335,346,368,401,621,665,676,687,698,709,720,731,742,753,764,885,896,907,918,929,940,995,1006,1017,1039,93,104,137,159,170,192,203,214,225,258,269,280,291,302,313,324,357,379,390,412,423,434,445,456,467,478,489,500,511,522,533,544,555,566,577,588,599,610,632,643,654,775,786,797,808,819,830,841,852,863,874,951,962,973,984,1028,6,17,28,39,50,61,72,83,116,127,149,182,237,248,336,347,369,402,622,666,677,688,699,710,721,732,743,754,765,886,897,908,919,930,941,996,1007,1018,1040,94,105,138,160,171,193,204,215,226,259,270,281,292,303,314,325,358,380,391,413,424,435,446,457,468,479,490,501,512,523,534,545,556,567,578,589,600,611,633,644,655,776,787,798,809,820,831,842,853,864,875,952,963,974,985,1029,7,18,29,40,51,62,73,84,117,128,150,183,238,249,337,348,370,403,623,667,678,689,700,711,722,733,744,755,766,887,898,909,920,931,942,997,1008,1019,1041,95,106,139,161,172,194,205,216,227,260,271,282,293,304,315,326,359,381,392,414,425,436,447,458,469,480,491,502,513,524,535,546,557,568,579,590,601,612,634,645,656,777,788,799,810,821,832,843,854,865,876,953,964,975,986,1030,8,19,30,41,52,63,74,85,118,129,151,184,239,250,338,349,371,404,624,668,679,690,701,712,723,734,745,756,767,888,899,910,921,932,943,998,1009,1020,1042,96,107,140,162,173,195,206,217,228,261,272,283,294,305,316,327,360,382,393,415,426,437,448,459,470,481,492,503,514,525,536,547,558,569,580,591,602,613,635,646,657,778,789,800,811,822,833,844,855,866,877,954,965,976,987,1031,240,251,350,372,625,680,691,702,713,724,735,746,757,768,889,900,911,922,933,944,999,1010,1021,1043,262,273,284,295,306,317,328,361,383,394,416,427,460,471,482,493,504,515,526,537,548,559,570,581,592,603,614,636,647,658,779,790,801,812,823,834,845,856,867,878,955,966,977,988,1032,240,251,262,273,284,295,306,350,372,460,471,559,570,592,625,845,317,328,361,383,394,416,427,482,493,504,515,526,537,548,581,603,614,636,647,658,680,691,702,713,724,735,746,757,768,779,790,801,812,823,834,856,867,878,889,900,911,922,933,944,955,966,977,988,999,1010,1021,1032,1043,241,252,351,373,626,681,692,703,714,725,736,747,758,769,890,901,912,923,934,945,1000,1011,1022,1044,263,274,285,296,307,318,329,362,384,395,417,428,461,472,483,494,505,516,527,538,549,560,571,582,593,604,615,637,648,659,780,791,802,813,824,835,846,857,868,879,956,967,978,989,1033,241,252,263,274,285,296,307,351,373,461,472,560,571,593,626,846,318,329,362,384,395,417,428,483,494,505,516,527,538,549,582,604,615,637,648,659,681,692,703,714,725,736,747,758,769,780,791,802,813,824,835,857,868,879,890,901,912,923,934,945,956,967,978,989,1000,1011,1022,1033,1044,242,253,352,374,627,682,693,704,715,726,737,748,759,770,891,902,913,924,935,946,1001,1012,1023,1045,264,275,286,297,308,319,330,363,385,396,418,429,462,473,484,495,506,517,528,539,550,561,572,583,594,605,616,638,649,660,781,792,803,814,825,836,847,858,869,880,957,968,979,990,1034,242,253,264,275,286,297,308,352,374,462,473,561,572,594,627,847,319,330,363,385,396,418,429,484,495,506,517,528,539,550,583,605,616,638,649,660,682,693,704,715,726,737,748,759,770,781,792,803,814,825,836,858,869,880,891,902,913,924,935,946,957,968,979,990,1001,1012,1023,1034,1045]),39,95);

    [L,~,P] = lu(M(:,1:19));
    P = P';
    M = [P*L P(:,20:end)]\M(:,20:end);
    M = M(end-19:end,:);

    T0 = zeros(56);
    T0([23,24,25,26,27,28,29,30,31,32,42,43,44,45,46,47,52,53,54,56],:) = -M(:,21:end);
    T0([785,842,899,956,1013,1070,1127,1184,1241,1410,1467,1524,1581,1638,1695,1752,1921,2034,2091,2148,2205,2262,2329,2386,2443,2500,2557,2614,2727,2784,2841,2904,2961,3018,3075,3135]) = 1;
    T1 = zeros(56);
    T1([23,24,25,26,27,28,29,30,31,32,42,43,44,45,46,47,52,53,54,56],[23,24,25,26,27,28,29,30,31,32,42,43,44,45,46,47,52,53,54,56]) = M(:,1:20);
    T1([1,58,115,172,229,286,343,400,457,514,571,628,685,742,799,856,913,970,1027,1084,1141,1198,1825,1882,1939,1996,2053,2110,2167,2224,2281,2680,2737,2794,2851,3079]) = 1;

    [V,~] = eig(T0,T1);
    S = V(52:55,:)./repmat(V(56,:),4,1);

    I = ~any(isnan(S)) & ~any(isinf(S));
    %I = I & ~any(imag(S)); % uncomment this line for real roots only
    S = S(:,I);

end