% Input: coefficient matrix C of size 10x20
% Output: solution matrix S of size 3x10

function S = red_10x20_5p(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],C([31,61,81,91,121,141,151,171,181,191,1,11,21,41,51,71,101,111,131,161,32,62,82,92,122,142,152,172,182,192,2,12,22,42,52,72,102,112,132,162,33,63,83,93,123,143,153,173,183,193,3,13,23,43,53,73,103,113,133,163,34,64,84,94,124,144,154,174,184,194,4,14,24,44,54,74,104,114,134,164,35,65,85,95,125,145,155,175,185,195,5,15,25,45,55,75,105,115,135,165,36,66,86,96,126,146,156,176,186,196,6,16,26,46,56,76,106,116,136,166,37,67,87,97,127,147,157,177,187,197,7,17,27,47,57,77,107,117,137,167,38,68,88,98,128,148,158,178,188,198,8,18,28,48,58,78,108,118,138,168,39,69,89,99,129,149,159,179,189,199,9,19,29,49,59,79,109,119,139,169,40,70,90,100,130,150,160,180,190,200,10,20,30,50,60,80,110,120,140,170]),10,20);

    [L,~,P] = lu(M(:,1:4));
    P = P';
    M = [P*L P(:,5:end)]\M(:,5:end);
    M = M(end-5:end,:);

    T0 = zeros(10);
    T0([3,5,6,8,9,10],:) = -M(:,7:end);
    T0([61,72,84,97]) = 1;
    T1 = zeros(10);
    T1([3,5,6,8,9,10],[3,5,6,8,9,10]) = M(:,1:6);
    T1([1,12,34,67]) = 1;

    [V,~] = eig(T0,T1);
    S = V(7:9,:)./repmat(V(10,:),3,1);

    I = ~any(isnan(S)) & ~any(isinf(S));
    %I = I & ~any(imag(S)); % uncomment this line for real roots only
    S = S(:,I);

end